! Copyright 2014-2021  Kazuya Ishimura
!
! Licensed under the Apache License, Version 2.0 (the "License");
! you may not use this file except in compliance with the License.
! You may obtain a copy of the License at
!
!     http://www.apache.org/licenses/LICENSE-2.0
!
! Unless required by applicable law or agreed to in writing, software
! distributed under the License is distributed on an "AS IS" BASIS,
! WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
! See the License for the specific language governing permissions and
! limitations under the License.
!
!--------------------------------------------------------------------------
  subroutine int2ddpp(phmdint,exfac1,exfac2,xyziq,xzkl,rot,nijkl,nbfijkl)
!--------------------------------------------------------------------------
!
! Calculate (dd|pp) integrals
!
! In  : exfac12, exfac34 (exponents and coefficients of primitive pair functions)
!       xyziq    (x,y,z elements of i and q)
!       xzkl     (x,z elements of k and l)
!       nij, nkl (number of primitive pair functions)
! Out : phmdint  (two-electron integral)
!
      use fmtgrid, only : fgrid, threshtval
      implicit none
      integer,intent(in) :: nijkl(2), nbfijkl(4)
      integer :: ij, kl, igrid, i, j, k, l, ii, ijcycle
      real(8),parameter :: zero=0.0D+00, one=1.0D+00, sqrtpi4=0.8862269254527580D+00
      real(8),parameter :: half=0.5D+00, two=2.0D+00, three=3.0D+00, four=4.0D+00, five=5.0D+00
      real(8),parameter :: six=6.0D+00, seven=7.0D+00, eight=8.0D+00, nine=9.0D+00, ten=1.0D+01
      real(8),parameter :: p11=1.1D+01, p15=1.5D+01, p45=4.5D+01
      real(8),parameter :: sqrt3=1.73205080756888D+00, sqrt3h=8.660254037844386D-01
      real(8),intent(in) :: exfac1(5,*), exfac2(5,*)
      real(8),intent(in) :: xyziq(3,*), xzkl(2), rot(3,3)
      real(8),intent(out) :: phmdint(6,6,6,6)
      real(8) :: tval, tval2, tval3, tval4, tval5, tval6, tval7, tval8, tval9, tval10
      real(8) :: tinv, ft(0:6)
      real(8) :: f0(2), f1(2,5), f2(3,5), f3(4,5), f4(5,5), f5(6,3), f6(7), ftw(6,5)
      real(8) :: r0(10), r1(3,18), r2(6,21), r3(10,16), r4(15,10), r5(21,4), r6(28)
      real(8) :: ex12, ex34, ex43, ex14, ex41, expq, expq2, expq4, ex3q, ex4q, c12, c34, zip
      real(8) :: xiq, yiq, ziq, xiq2, yiq2, xyiq, xiq4, yiq4, xyiq2, xiq6, yiq6, x4y2, x2y4
      real(8) :: xypq2, zpq, zpq2, zpq3, zpq4, zpq5, fac, ex33q, ex34q, ex44q, zjp
      real(8) :: pmd, qmd, qmd2, qmd3, qmd4, qmd4x, qmd4y, qmd4xy
      real(8) :: qx, qz, xx, xz, zz, xxx, xxz, xzz, zzz, xxxx, xxxz, xxzz, xzzz, zzzz
      real(8) :: eri(6,6,3,3), work(15), f1w(3,4), f2w(6,5), f3w(10,5), f4w(15,5), f5w(21,3)
      real(8) :: rot2(6,6), rot3(6,5)
      real(8) :: rrr(15), rxyz(45)
!
! Zero-clear
!
      r0(1:10)     = zero
      r1(1:3 ,1:18)= zero
      r2(1:6 ,1:21)= zero
      r3(1:10,1:16)= zero
      r4(1:15,1:10)= zero
      r5(1:21,1:4) = zero
      r6(1:28)     = zero
!
      do kl= 1,nijkl(2)
        ex34= exfac2(1,kl)
        ex43= exfac2(2,kl)
        ex3q= exfac2(3,kl)
        ex4q= exfac2(4,kl)
        c34 = exfac2(5,kl)
        xiq = xyziq(1,kl)
        yiq = xyziq(2,kl)
        ziq = xyziq(3,kl)
        xiq2= xiq*xiq
        yiq2= yiq*yiq
        xyiq= xiq*yiq
        xiq4= xiq2*xiq2
        yiq4= yiq2*yiq2
        xyiq2= xiq2*yiq2
        xiq6 = xiq4*xiq2
        yiq6 = yiq4*yiq2
        x4y2 = xiq4*yiq2
        x2y4 = xiq2*yiq4
        xypq2= xiq2+yiq2
        f0(1:2)    = zero
        f1(1:2,1:5)= zero
        f2(1:3,1:5)= zero
        f3(1:4,1:5)= zero
        f4(1:5,1:5)= zero
        f5(1:6,1:3)= zero
        f6(1:7)    = zero
        do ij= 1,nijkl(1)
          ex12= exfac1(1,ij)
          pmd = exfac1(2,ij)
          zjp = exfac1(3,ij)
          zip = exfac1(4,ij)
          c12 = exfac1(5,ij)
          ex14= ex12+ex34
          zpq = ziq-zip
          zpq2= zpq*zpq
          expq= ex12*ex34
          tval=(xypq2+zpq2)*expq
!
! Calculate Fm(T)
!
          if(tval >= threshtval*ex14) then
            tinv= one/sqrt(tval)
            ft(0)= c12*sqrtpi4*tinv
            expq= expq*tinv*tinv
            ft(1)= ft(0)*expq
            ft(2)= ft(1)*expq*three
            ft(3)= ft(2)*expq*five
            ft(4)= ft(3)*expq*seven
            ft(5)= ft(4)*expq*nine
            ft(6)= ft(5)*expq*p11
          else
            ex41= one/sqrt(ex14)
            tval= tval*ex41*ex41
            igrid= int(tval)
            tval2= tval *tval
            tval3= tval2*tval
            tval4= tval2*tval2
            tval5= tval2*tval3
            tval6= tval3*tval3
            tval7= tval4*tval3
            tval8= tval4*tval4
            tval9= tval4*tval5
            tval10=tval5*tval5
            do ii= 0,6
              ft(ii)= fgrid(0,ii,igrid)      +fgrid( 1,ii,igrid)*tval  +fgrid( 2,ii,igrid)*tval2 &
&                    +fgrid(3,ii,igrid)*tval3+fgrid( 4,ii,igrid)*tval4 +fgrid( 5,ii,igrid)*tval5 &
&                    +fgrid(6,ii,igrid)*tval6+fgrid( 7,ii,igrid)*tval7 +fgrid( 8,ii,igrid)*tval8 &
&                    +fgrid(9,ii,igrid)*tval9+fgrid(10,ii,igrid)*tval10
            enddo
            fac= c12*ex41
            expq= expq*two*ex41*ex41
            expq2= expq*expq
            expq4= expq2*expq2
            ft(0)= ft(0)*fac
            ft(1)= ft(1)*fac*expq
            ft(2)= ft(2)*fac*expq2
            ft(3)= ft(3)*fac*expq2*expq
            ft(4)= ft(4)*fac*expq4
            ft(5)= ft(5)*fac*expq4*expq
            ft(6)= ft(6)*fac*expq4*expq2
          endif
          zpq3= zpq2*zpq
          zpq4= zpq2*zpq2
          zpq5= zpq2*zpq2*zpq
          ftw(1,1)= zjp*zip
          ftw(1,2)= pmd
          ftw(1,3)= pmd*zjp
          ftw(1,4)= pmd*zip
          ftw(1,5)= pmd*pmd
          do i= 1,5
            ftw(2,i)= ftw(1,i)*zpq
            ftw(3,i)= ftw(1,i)*zpq2
            ftw(4,i)= ftw(1,i)*zpq3
            ftw(5,i)= ftw(1,i)*zpq4
            ftw(6,i)= ftw(1,i)*zpq5
          enddo
          f0(1)= f0(1)+ft(0)*ftw(1,1)
          f0(2)= f0(2)+ft(0)*ftw(1,2)
          do i= 1,4
            f1(1,i)= f1(1,i)-ft(1)*ftw(1,i)
            f1(2,i)= f1(2,i)-ft(1)*ftw(2,i)
          enddo
          f1(1,5)= f1(1,5)-ft(1)*ftw(1,5)
          do i= 1,5
            f2(1,i)= f2(1,i)+ft(2)*ftw(1,i)
            f2(2,i)= f2(2,i)+ft(2)*ftw(2,i)
            f2(3,i)= f2(3,i)+ft(2)*ftw(3,i)
          enddo
          do i= 1,5
            do j= 1,4
              f3(j,i)= f3(j,i)-ft(3)*ftw(j,i)
            enddo
          enddo
          do i= 1,5
            do j= 1,5
              f4(j,i)= f4(j,i)+ft(4)*ftw(j,i)
            enddo
          enddo
          do i= 1,3
            do j= 1,6
              f5(j,i)= f5(j,i)-ft(5)*ftw(j,i+2)
            enddo
          enddo
          f6(1)= f6(1)+ft(6)*ftw(1,5)
          f6(2)= f6(2)+ft(6)*ftw(2,5)
          f6(3)= f6(3)+ft(6)*ftw(3,5)
          f6(4)= f6(4)+ft(6)*ftw(4,5)
          f6(5)= f6(5)+ft(6)*ftw(5,5)
          f6(6)= f6(6)+ft(6)*ftw(6,5)
          f6(7)= f6(7)+ft(6)*ftw(6,5)*zpq
        enddo
!
        qmd = ex43*c34
        qmd2= qmd*ex43
        qmd3= qmd*ex43*ex43
        qmd4= qmd*ex43*ex43*ex43
        ex33q= ex3q*ex3q
        ex34q= ex3q*ex4q
        ex44q= ex4q*ex4q
        qmd4x= qmd4*xiq
        qmd4y= qmd4*yiq
        qmd4xy=qmd4*xiq*yiq
!
        work( 1)= qmd2
        work( 2)= qmd*ex33q
        work( 3)= qmd*ex34q
        work( 4)= qmd*ex44q
        work( 5)= ex33q*ex44q*c34
        work( 6)= qmd2*ex3q
        work( 7)= qmd2*ex4q
        work( 8)= qmd*ex34q*ex3q
        work( 9)= qmd*ex34q*ex4q
        work(10)= qmd3
        work(11)= qmd2*ex33q
        work(12)= qmd2*ex34q
        work(13)= qmd2*ex44q
        work(14)= qmd3*ex3q
        work(15)= qmd3*ex4q
!
        do i= 1,5
          r0(i  )= r0(i  )+f0(1)*work(i)
          r0(i+5)= r0(i+5)+f0(2)*work(i)
        enddo
!
        do i= 1,4
          f1w(1,i)= f1(1,i)*xiq
          f1w(2,i)= f1(1,i)*yiq
          f1w(3,i)= f1(2,i)
        enddo
        do i= 1,4
          do j= 1,3
            r1(j,i  )= r1(j,i  )+f1w(j,1)*work(i+5)
            r1(j,i+4)= r1(j,i+4)+f1w(j,2)*work(i+5)
          enddo
        enddo
        do i= 1,5
          do j= 1,3
            r1(j,i+ 8)= r1(j,i+ 8)+f1w(j,3)*work(i)
            r1(j,i+13)= r1(j,i+13)+f1w(j,4)*work(i)
          enddo
        enddo
!
        do i= 1,5
          f2w(1,i)= f2(1,i)*xiq2+f1(1,i)
          f2w(2,i)= f2(1,i)*yiq2+f1(1,i)
          f2w(3,i)= f2(3,i)     +f1(1,i)
          f2w(4,i)= f2(1,i)*xyiq
          f2w(5,i)= f2(2,i)*xiq
          f2w(6,i)= f2(2,i)*yiq
        enddo
        do i= 1,4
          do j= 1,6
            r2(j,i   )= r2(j,i   )+f2w(j,1)*work(i+9)
            r2(j,i+ 4)= r2(j,i+ 4)+f2w(j,2)*work(i+9)
            r2(j,i+ 8)= r2(j,i+ 8)+f2w(j,3)*work(i+5)
            r2(j,i+12)= r2(j,i+12)+f2w(j,4)*work(i+5)
          enddo
        enddo
        do i= 17,21
          do j= 1,6
            r2(j,i)= r2(j,i)+f2w(j,5)*work(i-16)
          enddo
        enddo
! 
        do i= 1,5
          f3w( 1,i)=(f3(1,i)*xiq2+f2(1,i)*three)*xiq
          f3w( 2,i)=(f3(1,i)*xiq2+f2(1,i)      )*yiq
          f3w( 3,i)=(f3(2,i)*xiq2+f2(2,i)      )
          f3w( 4,i)=(f3(1,i)*yiq2+f2(1,i)      )*xiq
          f3w( 5,i)=(f3(2,i)*xyiq              )
          f3w( 6,i)=(f3(3,i)     +f2(1,i)      )*xiq
          f3w( 7,i)=(f3(1,i)*yiq2+f2(1,i)*three)*yiq
          f3w( 8,i)=(f3(2,i)*yiq2+f2(2,i)      )
          f3w( 9,i)=(f3(3,i)     +f2(1,i)      )*yiq
          f3w(10,i)=(f3(4,i)     +f2(2,i)*three)
        enddo
        do i= 1,2
          do j= 1,10
            r3(j,i  )= r3(j,i  )+f3w(j,1)*work(i+13)
            r3(j,i+2)= r3(j,i+2)+f3w(j,2)*work(i+13)
          enddo
        enddo
        do i= 1,4
          do j= 1,10
            r3(j,i+ 4)= r3(j,i+ 4)+f3w(j,3)*work(i+9)
            r3(j,i+ 8)= r3(j,i+ 8)+f3w(j,4)*work(i+9)
            r3(j,i+12)= r3(j,i+12)+f3w(j,5)*work(i+5)
          enddo
        enddo
!
        do i= 1,5
          f4w( 1,i)=(f4(1,i)*xiq4 +f3(1,i)*xiq2*six         +f2(1,i)*three)
          f4w( 2,i)=(f4(1,i)*xiq2 +f3(1,i)*three                          )*xyiq
          f4w( 3,i)=(f4(2,i)*xiq2 +f3(2,i)*three                          )*xiq
          f4w( 4,i)=(f4(1,i)*xyiq2+f3(1,i)*xiq2+f3(1,i)*yiq2+f2(1,i)      )
          f4w( 5,i)=(f4(2,i)*xiq2 +f3(2,i)                                )*yiq
          f4w( 6,i)=(f4(3,i)*xiq2 +f3(1,i)*xiq2+f3(3,i)     +f2(1,i)      )
          f4w( 7,i)=(f4(1,i)*yiq2 +f3(1,i)*three                          )*xyiq
          f4w( 8,i)=(f4(2,i)*yiq2 +f3(2,i)                                )*xiq
          f4w( 9,i)=(f4(3,i)      +f3(1,i)                                )*xyiq
          f4w(10,i)=(f4(4,i)      +f3(2,i)*three                          )*xiq
          f4w(11,i)=(f4(1,i)*yiq4 +f3(1,i)*yiq2*six         +f2(1,i)*three)
          f4w(12,i)=(f4(2,i)*yiq2 +f3(2,i)*three                          )*yiq
          f4w(13,i)=(f4(3,i)*yiq2 +f3(1,i)*yiq2+f3(3,i)     +f2(1,i)      )
          f4w(14,i)=(f4(4,i)      +f3(2,i)*three                          )*yiq
          f4w(15,i)=(f4(5,i)      +f3(3,i)*six              +f2(1,i)*three)
        enddo
        do j= 1,15
          r4(j,1)= r4(j,1)+f4w(j,1)*qmd4
          r4(j,2)= r4(j,2)+f4w(j,2)*qmd4
        enddo
        do i= 1,2
          do j= 1,15
            r4(j,i+2)= r4(j,i+2)+f4w(j,3)*work(i+13)
            r4(j,i+4)= r4(j,i+4)+f4w(j,4)*work(i+13)
          enddo
        enddo
        do i= 7,10
          do j= 1,15
            r4(j,i)= r4(j,i)+f4w(j,5)*work(i+3)
          enddo
        enddo
!
        do i= 1,3
          f5w( 1,i)=(f5(1,i)*xiq4 +f4(1,i+2)*xiq2*ten                 +f3(1,i+2)*p15  )*xiq
          f5w( 2,i)=(f5(1,i)*xiq4 +f4(1,i+2)*xiq2*six                 +f3(1,i+2)*three)*yiq
          f5w( 3,i)=(f5(2,i)*xiq4 +f4(2,i+2)*xiq2*six                 +f3(2,i+2)*three)
          f5w( 4,i)=(f5(1,i)*xyiq2+f4(1,i+2)*xiq2+f4(1,i+2)*yiq2*three+f3(1,i+2)*three)*xiq
          f5w( 5,i)=(f5(2,i)*xiq2 +f4(2,i+2)*three                                    )*xyiq
          f5w( 6,i)=(f5(3,i)*xiq2 +f4(1,i+2)*xiq2+f4(3,i+2)*three     +f3(1,i+2)*three)*xiq
          f5w( 7,i)=(f5(1,i)*xyiq2+f4(1,i+2)*xiq2*three+f4(1,i+2)*yiq2+f3(1,i+2)*three)*yiq
          f5w( 8,i)=(f5(2,i)*xyiq2+f4(2,i+2)*xiq2+f4(2,i+2)*yiq2      +f3(2,i+2)      )
          f5w( 9,i)=(f5(3,i)*xiq2 +f4(1,i+2)*xiq2+f4(3,i+2)           +f3(1,i+2)      )*yiq
          f5w(10,i)=(f5(4,i)*xiq2 +f4(2,i+2)*xiq2*three+f4(4,i+2)     +f3(2,i+2)*three)
          f5w(11,i)=(f5(1,i)*yiq4 +f4(1,i+2)*yiq2*six                 +f3(1,i+2)*three)*xiq
          f5w(12,i)=(f5(2,i)*yiq2 +f4(2,i+2)*three                                    )*xyiq
          f5w(13,i)=(f5(3,i)*yiq2 +f4(1,i+2)*yiq2+f4(3,i+2)           +f3(1,i+2)      )*xiq
          f5w(14,i)=(f5(4,i)      +f4(2,i+2)*three                                    )*xyiq
          f5w(15,i)=(f5(5,i)      +f4(3,i+2)*six                      +f3(1,i+2)*three)*xiq
          f5w(16,i)=(f5(1,i)*yiq4 +f4(1,i+2)*yiq2*ten                 +f3(1,i+2)*p15  )*yiq
          f5w(17,i)=(f5(2,i)*yiq4 +f4(2,i+2)*yiq2*six                 +f3(2,i+2)*three)
          f5w(18,i)=(f5(3,i)*yiq2 +f4(1,i+2)*yiq2+f4(3,i+2)*three     +f3(1,i+2)*three)*yiq
          f5w(19,i)=(f5(4,i)*yiq2 +f4(2,i+2)*yiq2*three+f4(4,i+2)     +f3(2,i+2)*three)
          f5w(20,i)=(f5(5,i)      +f4(3,i+2)*six                      +f3(1,i+2)*three)*yiq
          f5w(21,i)=(f5(6,i)      +f4(4,i+2)*ten                      +f3(2,i+2)*p15  )
        enddo
        do j= 1,21
          r5(j,1)= r5(j,1)+f5w(j,1)*qmd4
          r5(j,2)= r5(j,2)+f5w(j,2)*qmd4
          r5(j,3)= r5(j,3)+f5w(j,3)*work(14)
          r5(j,4)= r5(j,4)+f5w(j,3)*work(15)
        enddo
!
        r6( 1)= r6( 1)+(f6(1)*xiq6+f5(1,3)*xiq4*p15+f4(1,5)*xiq2*p45+f3(1,5)*p15)*qmd4
        r6( 2)= r6( 2)+(f6(1)*xiq4+f5(1,3)*xiq2*ten+f4(1,5)*p15)*qmd4xy
        r6( 3)= r6( 3)+(f6(2)*xiq4+f5(2,3)*xiq2*ten+f4(2,5)*p15)*qmd4x
        r6( 4)= r6( 4)+(f6(1)*x4y2+f5(1,3)*xiq4+f5(1,3)*xyiq2*six+f4(1,5)*xiq2*six &
&                      +f4(1,5)*yiq2*three+f3(1,5)*three)*qmd4
        r6( 5)= r6( 5)+(f6(2)*xiq4+f5(2,3)*xiq2*six+f4(2,5)*three)*qmd4y
        r6( 6)= r6( 6)+(f6(3)*xiq4+f5(1,3)*xiq4+f5(3,3)*xiq2*six+f4(1,5)*xiq2*six &
&                      +f4(3,5)*three+f3(1,5)*three)*qmd4
        r6( 7)= r6( 7)+(f6(1)*xyiq2+f5(1,3)*xiq2*three+f5(1,3)*yiq2*three+f4(1,5)*nine)*qmd4xy
        r6( 8)= r6( 8)+(f6(2)*xyiq2+f5(2,3)*xiq2+f5(2,3)*yiq2*three+f4(2,5)*three)*qmd4x
        r6( 9)= r6( 9)+(f6(3)*xiq2+f5(1,3)*xiq2+f5(3,3)*three+f4(1,5)*three)*qmd4xy
        r6(10)= r6(10)+(f6(4)*xiq2+f5(2,3)*xiq2*three+f5(4,3)*three+f4(2,5)*nine)*qmd4x
        r6(11)= r6(11)+(f6(1)*x2y4+f5(1,3)*xyiq2*six+f5(1,3)*yiq4+f4(1,5)*xiq2*three &
&                      +f4(1,5)*yiq2*six+f3(1,5)*three)*qmd4
        r6(12)= r6(12)+(f6(2)*xyiq2+f5(2,3)*xiq2*three+f5(2,3)*yiq2+f4(2,5)*three)*qmd4y
        r6(13)= r6(13)+(f6(3)*xyiq2+f5(1,3)*xyiq2+f5(3,3)*xiq2+f5(3,3)*yiq2+f4(1,5)*xiq2 &
&                      +f4(1,5)*yiq2+f4(3,5)+f3(1,5))*qmd4
        r6(14)= r6(14)+(f6(4)*xiq2+f5(2,3)*xiq2*three+f5(4,3)+f4(2,5)*three)*qmd4y
        r6(15)= r6(15)+(f6(5)*xiq2+f5(3,3)*xiq2*six+f5(5,3)+f4(1,5)*xiq2*three+f4(3,5)*six &
&                      +f3(1,5)*three)*qmd4
        r6(16)= r6(16)+(f6(1)*yiq4+f5(1,3)*yiq2*ten+f4(1,5)*p15)*qmd4xy
        r6(17)= r6(17)+(f6(2)*yiq4+f5(2,3)*yiq2*six+f4(2,5)*three)*qmd4x
        r6(18)= r6(18)+(f6(3)*yiq2+f5(1,3)*yiq2+f5(3,3)*three+f4(1,5)*three)*qmd4xy
        r6(19)= r6(19)+(f6(4)*yiq2+f5(2,3)*yiq2*three+f5(4,3)+f4(2,5)*three)*qmd4x
        r6(20)= r6(20)+(f6(5)+f5(3,3)*six+f4(1,5)*three)*qmd4xy
        r6(21)= r6(21)+(f6(6)+f5(4,3)*ten+f4(2,5)*p15)*qmd4x
        r6(22)= r6(22)+(f6(1)*yiq6+f5(1,3)*yiq4*p15+f4(1,5)*yiq2*p45+f3(1,5)*p15)*qmd4
        r6(23)= r6(23)+(f6(2)*yiq4+f5(2,3)*yiq2*ten+f4(2,5)*p15)*qmd4y
        r6(24)= r6(24)+(f6(3)*yiq4+f5(1,3)*yiq4+f5(3,3)*yiq2*six+f4(1,5)*yiq2*six &
&                      +f4(3,5)*three+f3(1,5)*three)*qmd4
        r6(25)= r6(25)+(f6(4)*yiq2+f5(2,3)*yiq2*three+f5(4,3)*three+f4(2,5)*nine)*qmd4y
        r6(26)= r6(26)+(f6(5)*yiq2+f5(3,3)*yiq2*six+f5(5,3)+f4(1,5)*yiq2*three+f4(3,5)*six &
&                      +f3(1,5)*three)*qmd4
        r6(27)= r6(27)+(f6(6)+f5(4,3)*ten+f4(2,5)*p15)*qmd4y
        r6(28)= r6(28)+(f6(7)+f5(5,3)*p15+f4(3,5)*p45+f3(1,5)*p15)*qmd4
      enddo
!
      qx= xzkl(1)
      qz= xzkl(2)
      xx= qx*qx
      xz= qx*qz
      zz= qz*qz
      xxx= qx*qx*qx
      xxz= qx*qx*qz
      xzz= qx*qz*qz
      zzz= qz*qz*qz
      xxxx= xx*xx
      xxxz= xx*xz
      xxzz= xx*zz
      xzzz= xz*zz
      zzzz= zz*zz
      ijcycle= 0
      do i= 1,3
        do j= 1,3
          ijcycle= ijcycle+1
          select case(ijcycle)
            case(1)
              rrr( 1)=r6(1)+r4(1,2)+r4(1,7)*six+r2(1,5)*six+r2(1,17)*three+r0(6)*three
              rrr( 2)=r6(2)+r4(2,2)+r4(2,7)*three+r2(4,5)*three
              rrr( 3)=r6(3)+r4(3,2)+r4(3,7)*three+r2(5,5)*three
              rrr( 4)=r6(4)+r4(4,2)+r4(1,7)+r4(4,7)+r2(1,5)+r2(2,5)+r2(1,17)+r0(6)
              rrr( 5)=r6(5)+r4(5,2)+r4(5,7)+r2(6,5)
              rrr( 6)=r6(6)+r4(6,2)+r4(1,7)+r4(6,7)+r2(1,5)+r2(3,5)+r2(1,17)+r0(6)
              rrr( 7)=r6(7)+r4(7,2)+r4(2,7)*three+r2(4,5)*three
              rrr( 8)=r6(8)+r4(8,2)+r4(3,7)+r2(5,5)
              rrr( 9)=r6(9)+r4(9,2)+r4(2,7)+r2(4,5)
              rrr(10)=r6(10)+r4(10,2)+r4(3,7)*three+r2(5,5)*three
              rrr(11)=r6(11)+r4(11,2)+r4(4,7)*six+r2(2,5)*six+r2(1,17)*three+r0(6)*three
              rrr(12)=r6(12)+r4(12,2)+r4(5,7)*three+r2(6,5)*three
              rrr(13)=r6(13)+r4(13,2)+r4(4,7)+r4(6,7)+r2(2,5)+r2(3,5)+r2(1,17)+r0(6)
              rrr(14)=r6(14)+r4(14,2)+r4(5,7)*three+r2(6,5)*three
              rrr(15)=r6(15)+r4(15,2)+r4(6,7)*six+r2(3,5)*six+r2(1,17)*three+r0(6)*three
              rxyz( 1)=+r5(1,3)+r3(1,3)+r3(1,13)*three+r1(1,5)*three
              rxyz( 2)=+r5(1,4)+r3(1,4)+r3(1,14)*three+r1(1,6)*three
              rxyz( 3)=+r4(1,8)+r2(1,6)+r2(1,18)+r0(7)
              rxyz( 4)=+r4(1,9)+r2(1,7)+r2(1,19)+r0(8)
              rxyz( 5)=+r4(1,10)+r2(1,8)+r2(1,20)+r0(9)
              rxyz( 6)=+r3(1,15)+r1(1,7)
              rxyz( 7)=+r3(1,16)+r1(1,8)
              rxyz( 8)=+r2(1,21)+r0(10)
              rxyz( 9)=+r5(4,3)+r3(4,3)+r3(1,13)+r1(1,5)
              rxyz(10)=+r5(4,4)+r3(4,4)+r3(1,14)+r1(1,6)
              rxyz(11)=+r4(4,10)+r2(2,8)+r2(1,20)+r0(9)
              rxyz(12)=+r5(6,3)+r3(6,3)+r3(1,13)+r1(1,5)
              rxyz(13)=+r5(6,4)+r3(6,4)+r3(1,14)+r1(1,6)
              rxyz(14)=+r5(3,3)+r3(3,3)+r3(3,13)+r1(3,5)
              rxyz(15)=+r5(3,4)+r3(3,4)+r3(3,14)+r1(3,6)
              rxyz(16)=+r4(6,8)+r2(3,6)+r2(1,18)+r0(7)
              rxyz(17)=+r4(6,9)+r2(3,7)+r2(1,19)+r0(8)
              rxyz(18)=+r4(6,10)+r2(3,8)+r2(1,20)+r0(9)
              rxyz(19)=+r4(3,8)+r2(5,6)
              rxyz(20)=+r4(3,9)*two+r2(5,7)*two
              rxyz(21)=+r4(3,10)+r2(5,8)
              rxyz(22)=+r3(3,15)+r1(3,7)
              rxyz(23)=+r3(3,16)+r1(3,8)
              rxyz(24)=+r5(2,3)+r3(2,3)+r3(2,13)+r1(2,5)
              rxyz(25)=+r5(2,4)+r3(2,4)+r3(2,14)+r1(2,6)
              rxyz(26)=+r4(2,8)+r2(4,6)
              rxyz(27)=+r4(2,9)+r2(4,7)
              rxyz(28)=+r4(2,10)+r2(4,8)
              rxyz(29)=+r3(2,16)+r1(2,8)
              rxyz(30)=+r5(5,3)+r3(5,3)
              rxyz(31)=+r5(5,4)+r3(5,4)
              rxyz(32)=+r4(5,8)+r2(6,6)
              rxyz(33)=+r4(5,9)+r2(6,7)
              rxyz(34)=+r4(5,10)+r2(6,8)
              rxyz(35)=+r4(4,8)+r2(2,6)+r2(1,18)+r0(7)
              rxyz(36)=+r5(8,3)+r3(8,3)+r3(3,13)+r1(3,5)
              rxyz(37)=+r5(8,4)+r3(8,4)+r3(3,14)+r1(3,6)
              rxyz(38)=+r5(7,3)+r3(7,3)+r3(2,13)*three+r1(2,5)*three
              rxyz(39)=+r5(7,4)+r3(7,4)+r3(2,14)*three+r1(2,6)*three
              rxyz(40)=+r5(10,3)+r3(10,3)+r3(3,13)*three+r1(3,5)*three
              rxyz(41)=+r5(10,4)+r3(10,4)+r3(3,14)*three+r1(3,6)*three
              rxyz(42)=+r5(9,3)+r3(9,3)+r3(2,13)+r1(2,5)
              rxyz(43)=+r5(9,4)+r3(9,4)+r3(2,14)+r1(2,6)
              rxyz(44)=+r4(4,9)+r2(2,7)+r2(1,19)+r0(8)
              rxyz(45)=+r3(2,15)+r1(2,7)
            case(2)
              rrr( 1)= r6(2)+r4(2,7)*six+r2(4,17)*three
              rrr( 2)= r6(4)+r4(4,7)*three
              rrr( 3)= r6(5)+r4(5,7)*three
              rrr( 4)= r6(7)+r4(2,7)+r4(7,7)+r2(4,17)
              rrr( 5)= r6(8)+r4(8,7)
              rrr( 6)= r6(9)+r4(2,7)+r4(9,7)+r2(4,17)
              rrr( 7)= r6(11)+r4(4,7)*three
              rrr( 8)= r6(12)+r4(5,7)
              rrr( 9)= r6(13)+r4(4,7)
              rrr(10)= r6(14)+r4(5,7)*three
              rrr(11)= r6(16)+r4(7,7)*six+r2(4,17)*three
              rrr(12)= r6(17)+r4(8,7)*three
              rrr(13)= r6(18)+r4(7,7)+r4(9,7)+r2(4,17)
              rrr(14)= r6(19)+r4(8,7)*three
              rrr(15)= r6(20)+r4(9,7)*six+r2(4,17)*three
              rxyz( 1)=+r5(2,3)+r3(2,13)*three
              rxyz( 2)=+r5(2,4)+r3(2,14)*three
              rxyz( 3)=+r4(2,8)+r2(4,18)
              rxyz( 4)=+r4(2,9)+r2(4,19)
              rxyz( 5)=+r4(2,10)+r2(4,20)
              rxyz( 6)=+r3(2,15)
              rxyz( 7)=+r3(2,16)
              rxyz( 8)=+r2(4,21)
              rxyz( 9)=+r5(7,3)+r3(2,13)
              rxyz(10)=+r5(7,4)+r3(2,14)
              rxyz(11)=+r4(7,10)+r2(4,20)
              rxyz(12)=+r5(9,3)+r3(2,13)
              rxyz(13)=+r5(9,4)+r3(2,14)
              rxyz(14)=+r5(5,3)+r3(5,13)
              rxyz(15)=+r5(5,4)+r3(5,14)
              rxyz(16)=+r4(9,8)+r2(4,18)
              rxyz(17)=+r4(9,9)+r2(4,19)
              rxyz(18)=+r4(9,10)+r2(4,20)
              rxyz(19)=+r4(5,8)
              rxyz(20)=+r4(5,9)*two
              rxyz(21)=+r4(5,10)
              rxyz(22)=+r3(5,15)
              rxyz(23)=+r3(5,16)
              rxyz(24)=+r5(4,3)+r3(4,13)
              rxyz(25)=+r5(4,4)+r3(4,14)
              rxyz(26)=+r4(4,8)
              rxyz(27)=+r4(4,9)
              rxyz(28)=+r4(4,10)
              rxyz(29)=+r3(4,16)
              rxyz(30)=+r5(8,3)
              rxyz(31)=+r5(8,4)
              rxyz(32)=+r4(8,8)
              rxyz(33)=+r4(8,9)
              rxyz(34)=+r4(8,10)
              rxyz(35)=+r4(7,8)+r2(4,18)
              rxyz(36)=+r5(12,3)+r3(5,13)
              rxyz(37)=+r5(12,4)+r3(5,14)
              rxyz(38)=+r5(11,3)+r3(4,13)*three
              rxyz(39)=+r5(11,4)+r3(4,14)*three
              rxyz(40)=+r5(14,3)+r3(5,13)*three
              rxyz(41)=+r5(14,4)+r3(5,14)*three
              rxyz(42)=+r5(13,3)+r3(4,13)
              rxyz(43)=+r5(13,4)+r3(4,14)
              rxyz(44)=+r4(7,9)+r2(4,19)
              rxyz(45)=+r3(4,15)
            case(3)
              rrr( 1)= r6(3)-r5(1,1)+r4(3,7)*six-r3(1,5)*six+r2(5,17)*three-r1(1,9)*three
              rrr( 2)= r6(5)-r5(2,1)+r4(5,7)*three-r3(2,5)*three
              rrr( 3)= r6(6)-r5(3,1)+r4(6,7)*three-r3(3,5)*three
              rrr( 4)= r6(8)-r5(4,1)+r4(3,7)+r4(8,7)-r3(1,5)-r3(4,5)+r2(5,17)-r1(1,9)
              rrr( 5)= r6(9)-r5(5,1)+r4(9,7)-r3(5,5)
              rrr( 6)= r6(10)-r5(6,1)+r4(3,7)+r4(10,7)-r3(1,5)-r3(6,5)+r2(5,17)-r1(1,9)
              rrr( 7)= r6(12)-r5(7,1)+r4(5,7)*three-r3(2,5)*three
              rrr( 8)= r6(13)-r5(8,1)+r4(6,7)-r3(3,5)
              rrr( 9)= r6(14)-r5(9,1)+r4(5,7)-r3(2,5)
              rrr(10)= r6(15)-r5(10,1)+r4(6,7)*three-r3(3,5)*three
              rrr(11)= r6(17)-r5(11,1)+r4(8,7)*six-r3(4,5)*six+r2(5,17)*three-r1(1,9)*three
              rrr(12)= r6(18)-r5(12,1)+r4(9,7)*three-r3(5,5)*three
              rrr(13)= r6(19)-r5(13,1)+r4(8,7)+r4(10,7)-r3(4,5)-r3(6,5)+r2(5,17)-r1(1,9)
              rrr(14)= r6(20)-r5(14,1)+r4(9,7)*three-r3(5,5)*three
              rrr(15)= r6(21)-r5(15,1)+r4(10,7)*six-r3(6,5)*six+r2(5,17)*three-r1(1,9)*three
              rxyz( 1)=+r5(3,3)-r4(1,3)+r3(3,13)*three-r2(1,9)*three
              rxyz( 2)=+r5(3,4)-r4(1,4)+r3(3,14)*three-r2(1,10)*three
              rxyz( 3)=+r4(3,8)-r3(1,6)+r2(5,18)-r1(1,10)
              rxyz( 4)=+r4(3,9)-r3(1,7)+r2(5,19)-r1(1,11)
              rxyz( 5)=+r4(3,10)-r3(1,8)+r2(5,20)-r1(1,12)
              rxyz( 6)=+r3(3,15)-r2(1,11)
              rxyz( 7)=+r3(3,16)-r2(1,12)
              rxyz( 8)=+r2(5,21)-r1(1,13)
              rxyz( 9)=+r5(8,3)-r4(4,3)+r3(3,13)-r2(1,9)
              rxyz(10)=+r5(8,4)-r4(4,4)+r3(3,14)-r2(1,10)
              rxyz(11)=+r4(8,10)-r3(4,8)+r2(5,20)-r1(1,12)
              rxyz(12)=+r5(10,3)-r4(6,3)+r3(3,13)-r2(1,9)
              rxyz(13)=+r5(10,4)-r4(6,4)+r3(3,14)-r2(1,10)
              rxyz(14)=+r5(6,3)-r4(3,3)+r3(6,13)-r2(5,9)
              rxyz(15)=+r5(6,4)-r4(3,4)+r3(6,14)-r2(5,10)
              rxyz(16)=+r4(10,8)-r3(6,6)+r2(5,18)-r1(1,10)
              rxyz(17)=+r4(10,9)-r3(6,7)+r2(5,19)-r1(1,11)
              rxyz(18)=+r4(10,10)-r3(6,8)+r2(5,20)-r1(1,12)
              rxyz(19)=+r4(6,8)-r3(3,6)
              rxyz(20)=+r4(6,9)*two-r3(3,7)*two
              rxyz(21)=+r4(6,10)-r3(3,8)
              rxyz(22)=+r3(6,15)-r2(5,11)
              rxyz(23)=+r3(6,16)-r2(5,12)
              rxyz(24)=+r5(5,3)-r4(2,3)+r3(5,13)-r2(4,9)
              rxyz(25)=+r5(5,4)-r4(2,4)+r3(5,14)-r2(4,10)
              rxyz(26)=+r4(5,8)-r3(2,6)
              rxyz(27)=+r4(5,9)-r3(2,7)
              rxyz(28)=+r4(5,10)-r3(2,8)
              rxyz(29)=+r3(5,16)-r2(4,12)
              rxyz(30)=+r5(9,3)-r4(5,3)
              rxyz(31)=+r5(9,4)-r4(5,4)
              rxyz(32)=+r4(9,8)-r3(5,6)
              rxyz(33)=+r4(9,9)-r3(5,7)
              rxyz(34)=+r4(9,10)-r3(5,8)
              rxyz(35)=+r4(8,8)-r3(4,6)+r2(5,18)-r1(1,10)
              rxyz(36)=+r5(13,3)-r4(8,3)+r3(6,13)-r2(5,9)
              rxyz(37)=+r5(13,4)-r4(8,4)+r3(6,14)-r2(5,10)
              rxyz(38)=+r5(12,3)-r4(7,3)+r3(5,13)*three-r2(4,9)*three
              rxyz(39)=+r5(12,4)-r4(7,4)+r3(5,14)*three-r2(4,10)*three
              rxyz(40)=+r5(15,3)-r4(10,3)+r3(6,13)*three-r2(5,9)*three
              rxyz(41)=+r5(15,4)-r4(10,4)+r3(6,14)*three-r2(5,10)*three
              rxyz(42)=+r5(14,3)-r4(9,3)+r3(5,13)-r2(4,9)
              rxyz(43)=+r5(14,4)-r4(9,4)+r3(5,14)-r2(4,10)
              rxyz(44)=+r4(8,9)-r3(4,7)+r2(5,19)-r1(1,11)
              rxyz(45)=+r3(5,15)-r2(4,11)
            case(4)
              do k= 1,6
                do l= 1,6
                  eri(l,k,1,2)= eri(l,k,2,1)
                enddo
              enddo
              cycle
            case(5)
              rrr( 1)= r6(4)+r4(1,2)+r4(4,7)*six+r2(1,5)*six+r2(2,17)*three+r0(6)*three
              rrr( 2)= r6(7)+r4(2,2)+r4(7,7)*three+r2(4,5)*three
              rrr( 3)= r6(8)+r4(3,2)+r4(8,7)*three+r2(5,5)*three
              rrr( 4)= r6(11)+r4(4,2)+r4(4,7)+r4(11,7)+r2(1,5)+r2(2,5)+r2(2,17)+r0(6)
              rrr( 5)= r6(12)+r4(5,2)+r4(12,7)+r2(6,5)
              rrr( 6)= r6(13)+r4(6,2)+r4(4,7)+r4(13,7)+r2(1,5)+r2(3,5)+r2(2,17)+r0(6)
              rrr( 7)= r6(16)+r4(7,2)+r4(7,7)*three+r2(4,5)*three
              rrr( 8)= r6(17)+r4(8,2)+r4(8,7)+r2(5,5)
              rrr( 9)= r6(18)+r4(9,2)+r4(7,7)+r2(4,5)
              rrr(10)= r6(19)+r4(10,2)+r4(8,7)*three+r2(5,5)*three
              rrr(11)= r6(22)+r4(11,2)+r4(11,7)*six+r2(2,5)*six+r2(2,17)*three+r0(6)*three
              rrr(12)= r6(23)+r4(12,2)+r4(12,7)*three+r2(6,5)*three
              rrr(13)= r6(24)+r4(13,2)+r4(11,7)+r4(13,7)+r2(2,5)+r2(3,5)+r2(2,17)+r0(6)
              rrr(14)= r6(25)+r4(14,2)+r4(12,7)*three+r2(6,5)*three
              rrr(15)= r6(26)+r4(15,2)+r4(13,7)*six+r2(3,5)*six+r2(2,17)*three+r0(6)*three
              rxyz( 1)=+r5(4,3)+r3(1,3)+r3(4,13)*three+r1(1,5)*three
              rxyz( 2)=+r5(4,4)+r3(1,4)+r3(4,14)*three+r1(1,6)*three
              rxyz( 3)=+r4(4,8)+r2(1,6)+r2(2,18)+r0(7)
              rxyz( 4)=+r4(4,9)+r2(1,7)+r2(2,19)+r0(8)
              rxyz( 5)=+r4(4,10)+r2(1,8)+r2(2,20)+r0(9)
              rxyz( 6)=+r3(4,15)+r1(1,7)
              rxyz( 7)=+r3(4,16)+r1(1,8)
              rxyz( 8)=+r2(2,21)+r0(10)
              rxyz( 9)=+r5(11,3)+r3(4,3)+r3(4,13)+r1(1,5)
              rxyz(10)=+r5(11,4)+r3(4,4)+r3(4,14)+r1(1,6)
              rxyz(11)=+r4(11,10)+r2(2,8)+r2(2,20)+r0(9)
              rxyz(12)=+r5(13,3)+r3(6,3)+r3(4,13)+r1(1,5)
              rxyz(13)=+r5(13,4)+r3(6,4)+r3(4,14)+r1(1,6)
              rxyz(14)=+r5(8,3)+r3(3,3)+r3(8,13)+r1(3,5)
              rxyz(15)=+r5(8,4)+r3(3,4)+r3(8,14)+r1(3,6)
              rxyz(16)=+r4(13,8)+r2(3,6)+r2(2,18)+r0(7)
              rxyz(17)=+r4(13,9)+r2(3,7)+r2(2,19)+r0(8)
              rxyz(18)=+r4(13,10)+r2(3,8)+r2(2,20)+r0(9)
              rxyz(19)=+r4(8,8)+r2(5,6)
              rxyz(20)=+r4(8,9)*two+r2(5,7)*two
              rxyz(21)=+r4(8,10)+r2(5,8)
              rxyz(22)=+r3(8,15)+r1(3,7)
              rxyz(23)=+r3(8,16)+r1(3,8)
              rxyz(24)=+r5(7,3)+r3(2,3)+r3(7,13)+r1(2,5)
              rxyz(25)=+r5(7,4)+r3(2,4)+r3(7,14)+r1(2,6)
              rxyz(26)=+r4(7,8)+r2(4,6)
              rxyz(27)=+r4(7,9)+r2(4,7)
              rxyz(28)=+r4(7,10)+r2(4,8)
              rxyz(29)=+r3(7,16)+r1(2,8)
              rxyz(30)=+r5(12,3)+r3(5,3)
              rxyz(31)=+r5(12,4)+r3(5,4)
              rxyz(32)=+r4(12,8)+r2(6,6)
              rxyz(33)=+r4(12,9)+r2(6,7)
              rxyz(34)=+r4(12,10)+r2(6,8)
              rxyz(35)=+r4(11,8)+r2(2,6)+r2(2,18)+r0(7)
              rxyz(36)=+r5(17,3)+r3(8,3)+r3(8,13)+r1(3,5)
              rxyz(37)=+r5(17,4)+r3(8,4)+r3(8,14)+r1(3,6)
              rxyz(38)=+r5(16,3)+r3(7,3)+r3(7,13)*three+r1(2,5)*three
              rxyz(39)=+r5(16,4)+r3(7,4)+r3(7,14)*three+r1(2,6)*three
              rxyz(40)=+r5(19,3)+r3(10,3)+r3(8,13)*three+r1(3,5)*three
              rxyz(41)=+r5(19,4)+r3(10,4)+r3(8,14)*three+r1(3,6)*three
              rxyz(42)=+r5(18,3)+r3(9,3)+r3(7,13)+r1(2,5)
              rxyz(43)=+r5(18,4)+r3(9,4)+r3(7,14)+r1(2,6)
              rxyz(44)=+r4(11,9)+r2(2,7)+r2(2,19)+r0(8)
              rxyz(45)=+r3(7,15)+r1(2,7)
            case(6)
              rrr( 1)= r6(5)-r5(2,1)+r4(5,7)*six-r3(2,5)*six+r2(6,17)*three-r1(2,9)*three
              rrr( 2)= r6(8)-r5(4,1)+r4(8,7)*three-r3(4,5)*three
              rrr( 3)= r6(9)-r5(5,1)+r4(9,7)*three-r3(5,5)*three
              rrr( 4)= r6(12)-r5(7,1)+r4(5,7)+r4(12,7)-r3(2,5)-r3(7,5)+r2(6,17)-r1(2,9)
              rrr( 5)= r6(13)-r5(8,1)+r4(13,7)-r3(8,5)
              rrr( 6)= r6(14)-r5(9,1)+r4(5,7)+r4(14,7)-r3(2,5)-r3(9,5)+r2(6,17)-r1(2,9)
              rrr( 7)= r6(17)-r5(11,1)+r4(8,7)*three-r3(4,5)*three
              rrr( 8)= r6(18)-r5(12,1)+r4(9,7)-r3(5,5)
              rrr( 9)= r6(19)-r5(13,1)+r4(8,7)-r3(4,5)
              rrr(10)= r6(20)-r5(14,1)+r4(9,7)*three-r3(5,5)*three
              rrr(11)= r6(23)-r5(16,1)+r4(12,7)*six-r3(7,5)*six+r2(6,17)*three-r1(2,9)*three
              rrr(12)= r6(24)-r5(17,1)+r4(13,7)*three-r3(8,5)*three
              rrr(13)= r6(25)-r5(18,1)+r4(12,7)+r4(14,7)-r3(7,5)-r3(9,5)+r2(6,17)-r1(2,9)
              rrr(14)= r6(26)-r5(19,1)+r4(13,7)*three-r3(8,5)*three
              rrr(15)= r6(27)-r5(20,1)+r4(14,7)*six-r3(9,5)*six+r2(6,17)*three-r1(2,9)*three
              rxyz( 1)=+r5(5,3)-r4(2,3)+r3(5,13)*three-r2(4,9)*three
              rxyz( 2)=+r5(5,4)-r4(2,4)+r3(5,14)*three-r2(4,10)*three
              rxyz( 3)=+r4(5,8)-r3(2,6)+r2(6,18)-r1(2,10)
              rxyz( 4)=+r4(5,9)-r3(2,7)+r2(6,19)-r1(2,11)
              rxyz( 5)=+r4(5,10)-r3(2,8)+r2(6,20)-r1(2,12)
              rxyz( 6)=+r3(5,15)-r2(4,11)
              rxyz( 7)=+r3(5,16)-r2(4,12)
              rxyz( 8)=+r2(6,21)-r1(2,13)
              rxyz( 9)=+r5(12,3)-r4(7,3)+r3(5,13)-r2(4,9)
              rxyz(10)=+r5(12,4)-r4(7,4)+r3(5,14)-r2(4,10)
              rxyz(11)=+r4(12,10)-r3(7,8)+r2(6,20)-r1(2,12)
              rxyz(12)=+r5(14,3)-r4(9,3)+r3(5,13)-r2(4,9)
              rxyz(13)=+r5(14,4)-r4(9,4)+r3(5,14)-r2(4,10)
              rxyz(14)=+r5(9,3)-r4(5,3)+r3(9,13)-r2(6,9)
              rxyz(15)=+r5(9,4)-r4(5,4)+r3(9,14)-r2(6,10)
              rxyz(16)=+r4(14,8)-r3(9,6)+r2(6,18)-r1(2,10)
              rxyz(17)=+r4(14,9)-r3(9,7)+r2(6,19)-r1(2,11)
              rxyz(18)=+r4(14,10)-r3(9,8)+r2(6,20)-r1(2,12)
              rxyz(19)=+r4(9,8)-r3(5,6)
              rxyz(20)=+r4(9,9)*two-r3(5,7)*two
              rxyz(21)=+r4(9,10)-r3(5,8)
              rxyz(22)=+r3(9,15)-r2(6,11)
              rxyz(23)=+r3(9,16)-r2(6,12)
              rxyz(24)=+r5(8,3)-r4(4,3)+r3(8,13)-r2(2,9)
              rxyz(25)=+r5(8,4)-r4(4,4)+r3(8,14)-r2(2,10)
              rxyz(26)=+r4(8,8)-r3(4,6)
              rxyz(27)=+r4(8,9)-r3(4,7)
              rxyz(28)=+r4(8,10)-r3(4,8)
              rxyz(29)=+r3(8,16)-r2(2,12)
              rxyz(30)=+r5(13,3)-r4(8,3)
              rxyz(31)=+r5(13,4)-r4(8,4)
              rxyz(32)=+r4(13,8)-r3(8,6)
              rxyz(33)=+r4(13,9)-r3(8,7)
              rxyz(34)=+r4(13,10)-r3(8,8)
              rxyz(35)=+r4(12,8)-r3(7,6)+r2(6,18)-r1(2,10)
              rxyz(36)=+r5(18,3)-r4(12,3)+r3(9,13)-r2(6,9)
              rxyz(37)=+r5(18,4)-r4(12,4)+r3(9,14)-r2(6,10)
              rxyz(38)=+r5(17,3)-r4(11,3)+r3(8,13)*three-r2(2,9)*three
              rxyz(39)=+r5(17,4)-r4(11,4)+r3(8,14)*three-r2(2,10)*three
              rxyz(40)=+r5(20,3)-r4(14,3)+r3(9,13)*three-r2(6,9)*three
              rxyz(41)=+r5(20,4)-r4(14,4)+r3(9,14)*three-r2(6,10)*three
              rxyz(42)=+r5(19,3)-r4(13,3)+r3(8,13)-r2(2,9)
              rxyz(43)=+r5(19,4)-r4(13,4)+r3(8,14)-r2(2,10)
              rxyz(44)=+r4(12,9)-r3(7,7)+r2(6,19)-r1(2,11)
              rxyz(45)=+r3(8,15)-r2(2,11)
            case(7)
              rrr( 1)= r6(3)-r5(1,2)+r4(3,7)*six-r3(1,9)*six+r2(5,17)*three-r1(1,14)*three
              rrr( 2)= r6(5)-r5(2,2)+r4(5,7)*three-r3(2,9)*three
              rrr( 3)= r6(6)-r5(3,2)+r4(6,7)*three-r3(3,9)*three
              rrr( 4)= r6(8)-r5(4,2)+r4(3,7)+r4(8,7)-r3(1,9)-r3(4,9)+r2(5,17)-r1(1,14)
              rrr( 5)= r6(9)-r5(5,2)+r4(9,7)-r3(5,9)
              rrr( 6)= r6(10)-r5(6,2)+r4(3,7)+r4(10,7)-r3(1,9)-r3(6,9)+r2(5,17)-r1(1,14)
              rrr( 7)= r6(12)-r5(7,2)+r4(5,7)*three-r3(2,9)*three
              rrr( 8)= r6(13)-r5(8,2)+r4(6,7)-r3(3,9)
              rrr( 9)= r6(14)-r5(9,2)+r4(5,7)-r3(2,9)
              rrr(10)= r6(15)-r5(10,2)+r4(6,7)*three-r3(3,9)*three
              rrr(11)= r6(17)-r5(11,2)+r4(8,7)*six-r3(4,9)*six+r2(5,17)*three-r1(1,14)*three
              rrr(12)= r6(18)-r5(12,2)+r4(9,7)*three-r3(5,9)*three
              rrr(13)= r6(19)-r5(13,2)+r4(8,7)+r4(10,7)-r3(4,9)-r3(6,9)+r2(5,17)-r1(1,14)
              rrr(14)= r6(20)-r5(14,2)+r4(9,7)*three-r3(5,9)*three
              rrr(15)= r6(21)-r5(15,2)+r4(10,7)*six-r3(6,9)*six+r2(5,17)*three-r1(1,14)*three
              rxyz( 1)=+r5(3,3)-r4(1,5)+r3(3,13)*three-r2(1,13)*three
              rxyz( 2)=+r5(3,4)-r4(1,6)+r3(3,14)*three-r2(1,14)*three
              rxyz( 3)=+r4(3,8)-r3(1,10)+r2(5,18)-r1(1,15)
              rxyz( 4)=+r4(3,9)-r3(1,11)+r2(5,19)-r1(1,16)
              rxyz( 5)=+r4(3,10)-r3(1,12)+r2(5,20)-r1(1,17)
              rxyz( 6)=+r3(3,15)-r2(1,15)
              rxyz( 7)=+r3(3,16)-r2(1,16)
              rxyz( 8)=+r2(5,21)-r1(1,18)
              rxyz( 9)=+r5(8,3)-r4(4,5)+r3(3,13)-r2(1,13)
              rxyz(10)=+r5(8,4)-r4(4,6)+r3(3,14)-r2(1,14)
              rxyz(11)=+r4(8,10)-r3(4,12)+r2(5,20)-r1(1,17)
              rxyz(12)=+r5(10,3)-r4(6,5)+r3(3,13)-r2(1,13)
              rxyz(13)=+r5(10,4)-r4(6,6)+r3(3,14)-r2(1,14)
              rxyz(14)=+r5(6,3)-r4(3,5)+r3(6,13)-r2(5,13)
              rxyz(15)=+r5(6,4)-r4(3,6)+r3(6,14)-r2(5,14)
              rxyz(16)=+r4(10,8)-r3(6,10)+r2(5,18)-r1(1,15)
              rxyz(17)=+r4(10,9)-r3(6,11)+r2(5,19)-r1(1,16)
              rxyz(18)=+r4(10,10)-r3(6,12)+r2(5,20)-r1(1,17)
              rxyz(19)=+r4(6,8)-r3(3,10)
              rxyz(20)=+r4(6,9)*two-r3(3,11)*two
              rxyz(21)=+r4(6,10)-r3(3,12)
              rxyz(22)=+r3(6,15)-r2(5,15)
              rxyz(23)=+r3(6,16)-r2(5,16)
              rxyz(24)=+r5(5,3)-r4(2,5)+r3(5,13)-r2(4,13)
              rxyz(25)=+r5(5,4)-r4(2,6)+r3(5,14)-r2(4,14)
              rxyz(26)=+r4(5,8)-r3(2,10)
              rxyz(27)=+r4(5,9)-r3(2,11)
              rxyz(28)=+r4(5,10)-r3(2,12)
              rxyz(29)=+r3(5,16)-r2(4,16)
              rxyz(30)=+r5(9,3)-r4(5,5)
              rxyz(31)=+r5(9,4)-r4(5,6)
              rxyz(32)=+r4(9,8)-r3(5,10)
              rxyz(33)=+r4(9,9)-r3(5,11)
              rxyz(34)=+r4(9,10)-r3(5,12)
              rxyz(35)=+r4(8,8)-r3(4,10)+r2(5,18)-r1(1,15)
              rxyz(36)=+r5(13,3)-r4(8,5)+r3(6,13)-r2(5,13)
              rxyz(37)=+r5(13,4)-r4(8,6)+r3(6,14)-r2(5,14)
              rxyz(38)=+r5(12,3)-r4(7,5)+r3(5,13)*three-r2(4,13)*three
              rxyz(39)=+r5(12,4)-r4(7,6)+r3(5,14)*three-r2(4,14)*three
              rxyz(40)=+r5(15,3)-r4(10,5)+r3(6,13)*three-r2(5,13)*three
              rxyz(41)=+r5(15,4)-r4(10,6)+r3(6,14)*three-r2(5,14)*three
              rxyz(42)=+r5(14,3)-r4(9,5)+r3(5,13)-r2(4,13)
              rxyz(43)=+r5(14,4)-r4(9,6)+r3(5,14)-r2(4,14)
              rxyz(44)=+r4(8,9)-r3(4,11)+r2(5,19)-r1(1,16)
              rxyz(45)=+r3(5,15)-r2(4,15)
            case(8)
              rrr( 1)= r6(5)-r5(2,2)+r4(5,7)*six-r3(2,9)*six+r2(6,17)*three-r1(2,14)*three
              rrr( 2)= r6(8)-r5(4,2)+r4(8,7)*three-r3(4,9)*three
              rrr( 3)= r6(9)-r5(5,2)+r4(9,7)*three-r3(5,9)*three
              rrr( 4)= r6(12)-r5(7,2)+r4(5,7)+r4(12,7)-r3(2,9)-r3(7,9)+r2(6,17)-r1(2,14)
              rrr( 5)= r6(13)-r5(8,2)+r4(13,7)-r3(8,9)
              rrr( 6)= r6(14)-r5(9,2)+r4(5,7)+r4(14,7)-r3(2,9)-r3(9,9)+r2(6,17)-r1(2,14)
              rrr( 7)= r6(17)-r5(11,2)+r4(8,7)*three-r3(4,9)*three
              rrr( 8)= r6(18)-r5(12,2)+r4(9,7)-r3(5,9)
              rrr( 9)= r6(19)-r5(13,2)+r4(8,7)-r3(4,9)
              rrr(10)= r6(20)-r5(14,2)+r4(9,7)*three-r3(5,9)*three
              rrr(11)= r6(23)-r5(16,2)+r4(12,7)*six-r3(7,9)*six+r2(6,17)*three-r1(2,14)*three
              rrr(12)= r6(24)-r5(17,2)+r4(13,7)*three-r3(8,9)*three
              rrr(13)= r6(25)-r5(18,2)+r4(12,7)+r4(14,7)-r3(7,9)-r3(9,9)+r2(6,17)-r1(2,14)
              rrr(14)= r6(26)-r5(19,2)+r4(13,7)*three-r3(8,9)*three
              rrr(15)= r6(27)-r5(20,2)+r4(14,7)*six-r3(9,9)*six+r2(6,17)*three-r1(2,14)*three
              rxyz( 1)=+r5(5,3)-r4(2,5)+r3(5,13)*three-r2(4,13)*three
              rxyz( 2)=+r5(5,4)-r4(2,6)+r3(5,14)*three-r2(4,14)*three
              rxyz( 3)=+r4(5,8)-r3(2,10)+r2(6,18)-r1(2,15)
              rxyz( 4)=+r4(5,9)-r3(2,11)+r2(6,19)-r1(2,16)
              rxyz( 5)=+r4(5,10)-r3(2,12)+r2(6,20)-r1(2,17)
              rxyz( 6)=+r3(5,15)-r2(4,15)
              rxyz( 7)=+r3(5,16)-r2(4,16)
              rxyz( 8)=+r2(6,21)-r1(2,18)
              rxyz( 9)=+r5(12,3)-r4(7,5)+r3(5,13)-r2(4,13)
              rxyz(10)=+r5(12,4)-r4(7,6)+r3(5,14)-r2(4,14)
              rxyz(11)=+r4(12,10)-r3(7,12)+r2(6,20)-r1(2,17)
              rxyz(12)=+r5(14,3)-r4(9,5)+r3(5,13)-r2(4,13)
              rxyz(13)=+r5(14,4)-r4(9,6)+r3(5,14)-r2(4,14)
              rxyz(14)=+r5(9,3)-r4(5,5)+r3(9,13)-r2(6,13)
              rxyz(15)=+r5(9,4)-r4(5,6)+r3(9,14)-r2(6,14)
              rxyz(16)=+r4(14,8)-r3(9,10)+r2(6,18)-r1(2,15)
              rxyz(17)=+r4(14,9)-r3(9,11)+r2(6,19)-r1(2,16)
              rxyz(18)=+r4(14,10)-r3(9,12)+r2(6,20)-r1(2,17)
              rxyz(19)=+r4(9,8)-r3(5,10)
              rxyz(20)=+r4(9,9)*two-r3(5,11)*two
              rxyz(21)=+r4(9,10)-r3(5,12)
              rxyz(22)=+r3(9,15)-r2(6,15)
              rxyz(23)=+r3(9,16)-r2(6,16)
              rxyz(24)=+r5(8,3)-r4(4,5)+r3(8,13)-r2(2,13)
              rxyz(25)=+r5(8,4)-r4(4,6)+r3(8,14)-r2(2,14)
              rxyz(26)=+r4(8,8)-r3(4,10)
              rxyz(27)=+r4(8,9)-r3(4,11)
              rxyz(28)=+r4(8,10)-r3(4,12)
              rxyz(29)=+r3(8,16)-r2(2,16)
              rxyz(30)=+r5(13,3)-r4(8,5)
              rxyz(31)=+r5(13,4)-r4(8,6)
              rxyz(32)=+r4(13,8)-r3(8,10)
              rxyz(33)=+r4(13,9)-r3(8,11)
              rxyz(34)=+r4(13,10)-r3(8,12)
              rxyz(35)=+r4(12,8)-r3(7,10)+r2(6,18)-r1(2,15)
              rxyz(36)=+r5(18,3)-r4(12,5)+r3(9,13)-r2(6,13)
              rxyz(37)=+r5(18,4)-r4(12,6)+r3(9,14)-r2(6,14)
              rxyz(38)=+r5(17,3)-r4(11,5)+r3(8,13)*three-r2(2,13)*three
              rxyz(39)=+r5(17,4)-r4(11,6)+r3(8,14)*three-r2(2,14)*three
              rxyz(40)=+r5(20,3)-r4(14,5) +r3(9,13)*three-r2(6,13)*three
              rxyz(41)=+r5(20,4)-r4(14,6)+r3(9,14)*three-r2(6,14)*three
              rxyz(42)=+r5(19,3)-r4(13,5)+r3(8,13)-r2(2,13)
              rxyz(43)=+r5(19,4)-r4(13,6)+r3(8,14)-r2(2,14)
              rxyz(44)=+r4(12,9)-r3(7,11)+r2(6,19)-r1(2,16)
              rxyz(45)=+r3(8,15)-r2(2,15)
            case(9)
              rrr( 1)= r6(6)-r5(3,1)-r5(3,2)+r4(1,1)+r4(1,2)+r4(6,7)*six-r3(3,5)*six-r3(3,9)*six &
&                     +r2(1,1)*six+r2(1,5)*six+r2(3,17)*three-r1(3,9)*three-r1(3,14)*three &
&                     +r0(1)*three+r0(6)*three
              rrr( 2)= r6(9)-r5(5,1)-r5(5,2)+r4(2,1)+r4(2,2)+r4(9,7)*three-r3(5,5)*three &
&                     -r3(5,9)*three+r2(4,1)*three+r2(4,5)*three
              rrr( 3)= r6(10)-r5(6,1)-r5(6,2)+r4(3,1)+r4(3,2)+r4(10,7)*three-r3(6,5)*three &
&                     -r3(6,9)*three+r2(5,1)*three+r2(5,5)*three
              rrr( 4)= r6(13)-r5(8,1)-r5(8,2)+r4(4,1)+r4(4,2)+r4(6,7)+r4(13,7)-r3(3,5)-r3(8,5) &
&                     -r3(3,9)-r3(8,9)+r2(1,1)+r2(2,1)+r2(1,5)+r2(2,5)+r2(3,17)-r1(3,9)-r1(3,14) &
&                    +r0(1)+r0(6)
              rrr( 5)= r6(14)-r5(9,1)-r5(9,2)+r4(5,1)+r4(5,2)+r4(14,7)-r3(9,5)-r3(9,9)+r2(6,1) &
&                     +r2(6,5)
              rrr( 6)= r6(15)-r5(10,1)-r5(10,2)+r4(6,1)+r4(6,2)+r4(6,7)+r4(15,7)-r3(3,5)-r3(10,5) &
&                     -r3(3,9)-r3(10,9)+r2(1,1)+r2(3,1)+r2(1,5)+r2(3,5)+r2(3,17)-r1(3,9)-r1(3,14) &
&                     +r0(1)+r0(6)
              rrr( 7)= r6(18)-r5(12,1)-r5(12,2)+r4(7,1)+r4(7,2)+r4(9,7)*three-r3(5,5)*three &
&                     -r3(5,9)*three+r2(4,1)*three+r2(4,5)*three
              rrr( 8)= r6(19)-r5(13,1)-r5(13,2)+r4(8,1)+r4(8,2)+r4(10,7)-r3(6,5)-r3(6,9)+r2(5,1) &
&                     +r2(5,5)
              rrr( 9)= r6(20)-r5(14,1)-r5(14,2)+r4(9,1)+r4(9,2)+r4(9,7)-r3(5,5)-r3(5,9)+r2(4,1) &
&                     +r2(4,5)
              rrr(10)= r6(21)-r5(15,1)-r5(15,2)+r4(10,1)+r4(10,2)+r4(10,7)*three-r3(6,5)*three &
&                     -r3(6,9)*three+r2(5,1)*three+r2(5,5)*three
              rrr(11)= r6(24)-r5(17,1)-r5(17,2)+r4(11,1)+r4(11,2)+r4(13,7)*six-r3(8,5)*six &
&                     -r3(8,9)*six+r2(2,1)*six+r2(2,5)*six+r2(3,17)*three-r1(3,9)*three &
&                     -r1(3,14)*three+r0(1)*three+r0(6)*three
              rrr(12)= r6(25)-r5(18,1)-r5(18,2)+r4(12,1)+r4(12,2)+r4(14,7)*three-r3(9,5)*three &
&                     -r3(9,9)*three+r2(6,1)*three+r2(6,5)*three
              rrr(13)= r6(26)-r5(19,1)-r5(19,2)+r4(13,1)+r4(13,2)+r4(13,7)+r4(15,7)-r3(8,5) &
&                     -r3(10,5)-r3(8,9)-r3(10,9)+r2(2,1)+r2(3,1)+r2(2,5)+r2(3,5)+r2(3,17) &
&                     -r1(3,9)-r1(3,14)+r0(1)+r0(6)
              rrr(14)= r6(27)-r5(20,1)-r5(20,2)+r4(14,1)+r4(14,2)+r4(14,7)*three-r3(9,5)*three &
&                     -r3(9,9)*three+r2(6,1)*three+r2(6,5)*three
              rrr(15)= r6(28)-r5(21,1)-r5(21,2)+r4(15,1)+r4(15,2)+r4(15,7)*six-r3(10,5)*six &
&                     -r3(10,9)*six+r2(3,1)*six+r2(3,5)*six+r2(3,17)*three-r1(3,9)*three &
&                     -r1(3,14)*three+r0(1)*three+r0(6)*three
              rxyz( 1)=+r5(6,3)-r4(3,3)-r4(3,5)+r3(1,1)+r3(1,3)+r3(6,13)*three-r2(5,9)*three &
&                      -r2(5,13)*three+r1(1,1)*three+r1(1,5)*three
              rxyz( 2)=+r5(6,4)-r4(3,4)-r4(3,6)+r3(1,2)+r3(1,4)+r3(6,14)*three-r2(5,10)*three &
&                      -r2(5,14)*three+r1(1,2)*three+r1(1,6)*three
              rxyz( 3)=+r4(6,8)-r3(3,6)-r3(3,10)+r2(1,2)+r2(1,6)+r2(3,18)-r1(3,10)-r1(3,15) &
&                      +r0(2)+r0(7)
              rxyz( 4)=+r4(6,9)-r3(3,7)-r3(3,11)+r2(1,3)+r2(1,7)+r2(3,19)-r1(3,11)-r1(3,16) &
&                      +r0(3)+r0(8)
              rxyz( 5)=+r4(6,10)-r3(3,8)-r3(3,12)+r2(1,4)+r2(1,8)+r2(3,20)-r1(3,12)-r1(3,17) &
&                      +r0(4)+r0(9)
              rxyz( 6)=+r3(6,15)-r2(5,11)-r2(5,15)+r1(1,3)+r1(1,7)
              rxyz( 7)=+r3(6,16)-r2(5,12)-r2(5,16)+r1(1,4)+r1(1,8)
              rxyz( 8)=+r2(3,21)-r1(3,13)-r1(3,18)+r0(5)+r0(10)
              rxyz( 9)=+r5(13,3)-r4(8,3)-r4(8,5)+r3(4,1)+r3(4,3)+r3(6,13)-r2(5,9)-r2(5,13) &
&                      +r1(1,1)+r1(1,5)
              rxyz(10)=+r5(13,4)-r4(8,4)-r4(8,6)+r3(4,2)+r3(4,4)+r3(6,14)-r2(5,10)-r2(5,14) &
&                      +r1(1,2)+r1(1,6)
              rxyz(11)=+r4(13,10)-r3(8,8)-r3(8,12)+r2(2,4)+r2(2,8)+r2(3,20)-r1(3,12)-r1(3,17) &
&                      +r0(4)+r0(9)
              rxyz(12)=+r5(15,3)-r4(10,3)-r4(10,5)+r3(6,1)+r3(6,3)+r3(6,13)-r2(5,9)-r2(5,13) &
&                      +r1(1,1)+r1(1,5)
              rxyz(13)=+r5(15,4)-r4(10,4)-r4(10,6)+r3(6,2)+r3(6,4)+r3(6,14)-r2(5,10)-r2(5,14) &
&                      +r1(1,2)+r1(1,6)
              rxyz(14)=+r5(10,3)-r4(6,3)-r4(6,5)+r3(3,1)+r3(3,3)+r3(10,13)-r2(3,9)-r2(3,13) &
&                      +r1(3,1)+r1(3,5)
              rxyz(15)=+r5(10,4)-r4(6,4)-r4(6,6)+r3(3,2)+r3(3,4)+r3(10,14)-r2(3,10)-r2(3,14) &
&                      +r1(3,2)+r1(3,6)
              rxyz(16)=+r4(15,8)-r3(10,6)-r3(10,10)+r2(3,2)+r2(3,6)+r2(3,18)-r1(3,10)-r1(3,15) &
&                      +r0(2)+r0(7)
              rxyz(17)=+r4(15,9)-r3(10,7)-r3(10,11)+r2(3,3)+r2(3,7)+r2(3,19)-r1(3,11)-r1(3,16) &
&                      +r0(3)+r0(8)
              rxyz(18)=+r4(15,10)-r3(10,8)-r3(10,12)+r2(3,4)+r2(3,8)+r2(3,20)-r1(3,12)-r1(3,17) &
&                      +r0(4)+r0(9)
              rxyz(19)=+r4(10,8)-r3(6,6)-r3(6,10)+r2(5,2)+r2(5,6)
              rxyz(20)=+r4(10,9)*two-r3(6,7)*two-r3(6,11)*two+r2(5,3)*two+r2(5,7)*two
              rxyz(21)=+r4(10,10)-r3(6,8)-r3(6,12)+r2(5,4)+r2(5,8)
              rxyz(22)=+r3(10,15)-r2(3,11)-r2(3,15)+r1(3,3)+r1(3,7)
              rxyz(23)=+r3(10,16)-r2(3,12)-r2(3,16)+r1(3,4)+r1(3,8)
              rxyz(24)=+r5(9,3)-r4(5,3)-r4(5,5)+r3(2,1)+r3(2,3)+r3(9,13)-r2(6,9)-r2(6,13) &
&                      +r1(2,1)+r1(2,5)
              rxyz(25)=+r5(9,4)-r4(5,4)-r4(5,6)+r3(2,2)+r3(2,4)+r3(9,14)-r2(6,10)-r2(6,14) &
&                      +r1(2,2)+r1(2,6)
              rxyz(26)=+r4(9,8)-r3(5,6)-r3(5,10)+r2(4,2)+r2(4,6)
              rxyz(27)=+r4(9,9)-r3(5,7)-r3(5,11)+r2(4,3)+r2(4,7)
              rxyz(28)=+r4(9,10)-r3(5,8)-r3(5,12)+r2(4,4)+r2(4,8)
              rxyz(29)=+r3(9,16)-r2(6,12)-r2(6,16)+r1(2,4)+r1(2,8)
              rxyz(30)=+r5(14,3)-r4(9,3)-r4(9,5)+r3(5,1)+r3(5,3)
              rxyz(31)=+r5(14,4)-r4(9,4)-r4(9,6)+r3(5,2)+r3(5,4)
              rxyz(32)=+r4(14,8)-r3(9,6)-r3(9,10)+r2(6,2)+r2(6,6)
              rxyz(33)=+r4(14,9)-r3(9,7)-r3(9,11)+r2(6,3)+r2(6,7)
              rxyz(34)=+r4(14,10)-r3(9,8)-r3(9,12)+r2(6,4)+r2(6,8)
              rxyz(35)=+r4(13,8)-r3(8,6)-r3(8,10)+r2(2,2)+r2(2,6)+r2(3,18)-r1(3,10)-r1(3,15) &
&                      +r0(2)+r0(7)
              rxyz(36)=+r5(19,3)-r4(13,3)-r4(13,5)+r3(8,1)+r3(8,3)+r3(10,13)-r2(3,9)-r2(3,13) &
&                      +r1(3,1)+r1(3,5)
              rxyz(37)=+r5(19,4)-r4(13,4)-r4(13,6)+r3(8,2)+r3(8,4)+r3(10,14)-r2(3,10)-r2(3,14) &
&                      +r1(3,2)+r1(3,6)
              rxyz(38)=+r5(18,3)-r4(12,3)-r4(12,5)+r3(7,1)+r3(7,3)+r3(9,13)*three-r2(6,9)*three &
&                      -r2(6,13)*three+r1(2,1)*three+r1(2,5)*three
              rxyz(39)=+r5(18,4)-r4(12,4)-r4(12,6)+r3(7,2)+r3(7,4)+r3(9,14)*three-r2(6,10)*three &
&                      -r2(6,14)*three+r1(2,2)*three+r1(2,6)*three
              rxyz(40)=+r5(21,3)-r4(15,3)-r4(15,5)+r3(10,1)+r3(10,3)+r3(10,13)*three &
&                      -r2(3,9)*three-r2(3,13)*three+r1(3,1)*three+r1(3,5)*three
              rxyz(41)=+r5(21,4)-r4(15,4)-r4(15,6)+r3(10,2)+r3(10,4)+r3(10,14)*three &
&                      -r2(3,10)*three-r2(3,14)*three+r1(3,2)*three+r1(3,6)*three
              rxyz(42)=+r5(20,3)-r4(14,3)-r4(14,5)+r3(9,1)+r3(9,3)+r3(9,13)-r2(6,9)-r2(6,13) &
&                      +r1(2,1)+r1(2,5)
              rxyz(43)=+r5(20,4)-r4(14,4)-r4(14,6)+r3(9,2)+r3(9,4)+r3(9,14)-r2(6,10)-r2(6,14) &
&                      +r1(2,2)+r1(2,6)
              rxyz(44)=+r4(13,9)-r3(8,7)-r3(8,11)+r2(2,3)+r2(2,7)+r2(3,19)-r1(3,11)-r1(3,16) &
&                      +r0(3)+r0(8)
              rxyz(45)=+r3(9,15)-r2(6,11)-r2(6,15)+r1(2,3)+r1(2,7)
          end select
          eri(1,1,j,i)=rrr(1)+(rxyz(1)+rxyz(2))*two*qx+(rxyz(3)+rxyz(4)*four+rxyz(5))*xx &
&                      +(rxyz(6)+rxyz(7))*two*xxx+rxyz(8)*xxxx
          eri(2,1,j,i)=rrr(4)+rxyz(10)*two*qx+rxyz(11)*xx
          eri(3,1,j,i)=rrr(6)+rxyz(13)*two*qx+rxyz(14)*two*qz+rxyz(18)*xx+rxyz(20)*two*xz &
&                      +rxyz(3)*zz+rxyz(23)*two*xxz+rxyz(6)*two*xzz+rxyz(8)*xxzz
          eri(4,1,j,i)=rrr(2)+(rxyz(24)+rxyz(25)*two)*qx+(rxyz(27)*two+rxyz(28))*xx &
&                      +rxyz(29)*xxx
          eri(5,1,j,i)=rrr(3)+(rxyz(14)+rxyz(15)*two)*qx+rxyz(1)*qz+(rxyz(20)+rxyz(21))*xx &
&                      +(rxyz(3)+rxyz(4)*two)*xz+rxyz(23)*xxx+(rxyz(6)*two+rxyz(7))*xxz &
&                      +rxyz(8)*xxxz
          eri(6,1,j,i)=rrr(5)+rxyz(31)*two*qx+rxyz(24)*qz+rxyz(34)*xx+rxyz(27)*two*xz+rxyz(29)*xxz
          eri(1,2,j,i)=rrr(4)+rxyz(9)*two*qx+rxyz(35)*xx
          eri(2,2,j,i)=rrr(11)
          eri(3,2,j,i)=rrr(13)+rxyz(36)*two*qz+rxyz(35)*zz
          eri(4,2,j,i)=rrr(7)+rxyz(38)*qx
          eri(5,2,j,i)=rrr(8)+rxyz(36)*qx+rxyz(9)*qz+rxyz(35)*xz
          eri(6,2,j,i)=rrr(12)+rxyz(38)*qz
          eri(1,3,j,i)=rrr(6)+rxyz(12)*two*qx+rxyz(15)*two*qz+rxyz(16)*xx+rxyz(20)*two*xz &
&                      +rxyz(5)*zz+rxyz(22)*two*xxz+rxyz(7)*two*xzz+rxyz(8)*xxzz
          eri(2,3,j,i)=rrr(13)+rxyz(37)*two*qz+rxyz(11)*zz
          eri(3,3,j,i)=rrr(15)+(rxyz(40)+rxyz(41))*two*qz+(rxyz(16)+rxyz(17)*four+rxyz(18)) &
&                      *zz+(rxyz(22)+rxyz(23))*two*zzz+rxyz(8)*zzzz
          eri(4,3,j,i)=rrr(9)+rxyz(42)*qx+rxyz(31)*two*qz+rxyz(33)*two*xz+rxyz(28)*zz+rxyz(29)*xzz
          eri(5,3,j,i)=rrr(10)+rxyz(40)*qx+(rxyz(12)+rxyz(13)*two)*qz+(rxyz(16)+rxyz(17)*two)*xz &
&                      +(rxyz(20)+rxyz(21))*zz+(rxyz(22)*two+rxyz(23))*xzz+rxyz(7)*zzz &
&                      +rxyz(8)*xzzz
          eri(6,3,j,i)=rrr(14)+(rxyz(42)+rxyz(43)*two)*qz+(rxyz(33)*two+rxyz(34))*zz+rxyz(29)*zzz
          eri(1,4,j,i)=rrr(2)+(rxyz(24)*two+rxyz(25))*qx+(rxyz(26)+rxyz(27)*two)*xx+rxyz(45)*xxx
          eri(2,4,j,i)=rrr(7)+rxyz(39)*qx
          eri(3,4,j,i)=rrr(9)+rxyz(43)*qx+rxyz(30)*two*qz+rxyz(33)*two*xz+rxyz(26)*zz+rxyz(45)*xzz
          eri(4,4,j,i)=rrr(4)+(rxyz(9)+rxyz(10))*qx+rxyz(44)*xx
          eri(5,4,j,i)=rrr(5)+(rxyz(30)+rxyz(31))*qx+rxyz(24)*qz+rxyz(33)*xx+(rxyz(26) &
&                      +rxyz(27))*xz+rxyz(45)*xxz
          eri(6,4,j,i)=rrr(8)+rxyz(37)*qx+rxyz(9)*qz+rxyz(44)*xz
          eri(1,5,j,i)=rrr(3)+(rxyz(14)*two+rxyz(15))*qx+rxyz(2)*qz+(rxyz(19)+rxyz(20))*xx &
&                      +(rxyz(4)*two+rxyz(5))*xz+rxyz(22)*xxx+(rxyz(6)+rxyz(7)*two)*xxz &
&                      +rxyz(8)*xxxz
          eri(2,5,j,i)=rrr(8)+rxyz(37)*qx+rxyz(10)*qz+rxyz(11)*xz
          eri(3,5,j,i)=rrr(10)+rxyz(41)*qx+(rxyz(12)*two+rxyz(13))*qz+(rxyz(17)*two+rxyz(18))*xz &
&                      +(rxyz(19)+rxyz(20))*zz+(rxyz(22)+rxyz(23)*two)*xzz+rxyz(6)*zzz &
&                      +rxyz(8)*xzzz
          eri(4,5,j,i)=rrr(5)+(rxyz(30)+rxyz(31))*qx+rxyz(25)*qz+rxyz(33)*xx+(rxyz(27) &
&                      +rxyz(28))*xz+rxyz(29)*xxz
          eri(5,5,j,i)=rrr(6)+(rxyz(12)+rxyz(13))*qx+(rxyz(14)+rxyz(15))*qz+rxyz(17)*xx &
&                      +(rxyz(19)+rxyz(20)+rxyz(21))*xz+rxyz(4)*zz+(rxyz(22)+rxyz(23))*xxz &
&                      +(rxyz(6)+rxyz(7))*xzz+rxyz(8)*xxzz
          eri(6,5,j,i)=rrr(9)+rxyz(43)*qx+(rxyz(30)+rxyz(31))*qz+(rxyz(33)+rxyz(34))*xz &
&                      +rxyz(27)*zz+rxyz(29)*xzz
          eri(1,6,j,i)=rrr(5)+rxyz(30)*two*qx+rxyz(25)*qz+rxyz(32)*xx+rxyz(27)*two*xz+rxyz(45)*xxz
          eri(2,6,j,i)=rrr(12)+rxyz(39)*qz
          eri(3,6,j,i)=rrr(14)+(rxyz(42)*two+rxyz(43))*qz+(rxyz(32)+rxyz(33)*two)*zz+rxyz(45)*zzz
          eri(4,6,j,i)=rrr(8)+rxyz(36)*qx+rxyz(10)*qz+rxyz(44)*xz
          eri(5,6,j,i)=rrr(9)+rxyz(42)*qx+(rxyz(30)+rxyz(31))*qz+(rxyz(32)+rxyz(33))*xz &
&                      +rxyz(27)*zz+rxyz(45)*xzz
          eri(6,6,j,i)=rrr(13)+(rxyz(36)+rxyz(37))*qz+rxyz(44)*zz
        end do
      end do
!
      rot2(1,1)= rot(1,1)*rot(1,1)
      rot2(2,1)= rot(2,1)*rot(2,1)
      rot2(3,1)= rot(3,1)*rot(3,1)
      rot2(4,1)= rot(1,1)*rot(2,1)*two
      rot2(5,1)= rot(1,1)*rot(3,1)*two
      rot2(6,1)= rot(2,1)*rot(3,1)*two
      do l= 2,3
        rot2(1,l)= rot(1,1)*rot(1,l)*sqrt3
        rot2(2,l)= rot(2,1)*rot(2,l)*sqrt3
        rot2(3,l)= rot(3,1)*rot(3,l)*sqrt3
        rot2(4,l)=(rot(1,1)*rot(2,l)+rot(2,1)*rot(1,l))*sqrt3
        rot2(5,l)=(rot(1,1)*rot(3,l)+rot(3,1)*rot(1,l))*sqrt3
        rot2(6,l)=(rot(2,1)*rot(3,l)+rot(3,1)*rot(2,l))*sqrt3
      enddo
      do l= 2,3
        rot2(1,l*2)= rot(1,l)*rot(1,l)
        rot2(2,l*2)= rot(2,l)*rot(2,l)
        rot2(3,l*2)= rot(3,l)*rot(3,l)
        rot2(4,l*2)= rot(1,l)*rot(2,l)*two
        rot2(5,l*2)= rot(1,l)*rot(3,l)*two
        rot2(6,l*2)= rot(2,l)*rot(3,l)*two
      enddo
      rot2(1,5)= rot(1,2)*rot(1,3)*sqrt3
      rot2(2,5)= rot(2,2)*rot(2,3)*sqrt3
      rot2(3,5)= rot(3,2)*rot(3,3)*sqrt3
      rot2(4,5)=(rot(1,2)*rot(2,3)+rot(2,2)*rot(1,3))*sqrt3
      rot2(5,5)=(rot(1,2)*rot(3,3)+rot(3,2)*rot(1,3))*sqrt3
      rot2(6,5)=(rot(2,2)*rot(3,3)+rot(3,2)*rot(2,3))*sqrt3
!
      do l= 1,6
        rot3(l,1)= rot2(l,2)
        rot3(l,2)= rot2(l,5)
        rot3(l,3)= rot2(l,6)-(rot2(l,1)+rot2(l,4))*half
        rot3(l,4)= rot2(l,3)
        rot3(l,5)=(rot2(l,1)-rot2(l,4))*sqrt3h
      enddo
!
      do j= 1,3
        do k= 1,6
          do l= 1,6
            work(1)= eri(l,k,j,1)
            work(2)= eri(l,k,j,2)
            work(3)= eri(l,k,j,3)
            eri(l,k,j,1)= work(1)*rot(1,1)+work(2)*rot(2,1)+work(3)*rot(3,1)
            eri(l,k,j,2)= work(1)*rot(1,2)+work(2)*rot(2,2)+work(3)*rot(3,2)
            eri(l,k,j,3)= work(1)*rot(1,3)+work(2)*rot(2,3)+work(3)*rot(3,3)
          enddo
        enddo
      enddo
      do i= 1,3
        do k= 1,6
          do l= 1,6
            work(1)= eri(l,k,1,i)
            work(2)= eri(l,k,2,i)
            work(3)= eri(l,k,3,i)
            eri(l,k,1,i)= work(1)*rot(1,1)+work(2)*rot(2,1)+work(3)*rot(3,1)
            eri(l,k,2,i)= work(1)*rot(1,2)+work(2)*rot(2,2)+work(3)*rot(3,2)
            eri(l,k,3,i)= work(1)*rot(1,3)+work(2)*rot(2,3)+work(3)*rot(3,3)
          enddo
        enddo
      enddo
      if(nbfijkl(3) == 6)then
        do i= 1,3
          do j= 1,3
            do l= 1,6
              do k= 1,6
                work(k)= eri(l,k,j,i)
              enddo
              do k= 1,6
                eri(l,k,j,i)= work(1)*rot2(1,k)+work(2)*rot2(2,k)+work(3)*rot2(3,k) &
&                            +work(4)*rot2(4,k)+work(5)*rot2(5,k)+work(6)*rot2(6,k)
              enddo
            enddo
          enddo
        enddo
      else
        do i= 1,3
          do j= 1,3
            do l= 1,6
              do k= 1,6
                work(k)= eri(l,k,j,i)
              enddo
              do k= 1,5
                eri(l,k,j,i)= work(1)*rot3(1,k)+work(2)*rot3(2,k)+work(3)*rot3(3,k) &
&                            +work(4)*rot3(4,k)+work(5)*rot3(5,k)+work(6)*rot3(6,k)
              enddo
            enddo
          enddo
        enddo
      endif
!
      if(nbfijkl(4) == 6)then
        do i= 1,3
          do j= 1,3
            do k= 1,nbfijkl(3)
              do l= 1,6
                phmdint(l,k,j,i)= &
&                   eri(1,k,j,i)*rot2(1,l)+eri(2,k,j,i)*rot2(2,l)+eri(3,k,j,i)*rot2(3,l) &
&                  +eri(4,k,j,i)*rot2(4,l)+eri(5,k,j,i)*rot2(5,l)+eri(6,k,j,i)*rot2(6,l) 
              enddo
            enddo
          enddo
        enddo
      else
        do i= 1,3
          do j= 1,3
            do k= 1,nbfijkl(3)
              do l= 1,5
                phmdint(l,k,j,i)= &
&                   eri(1,k,j,i)*rot3(1,l)+eri(2,k,j,i)*rot3(2,l)+eri(3,k,j,i)*rot3(3,l) &
&                  +eri(4,k,j,i)*rot3(4,l)+eri(5,k,j,i)*rot3(5,l)+eri(6,k,j,i)*rot3(6,l)
              enddo
            enddo
          enddo
        enddo
      endif
!
      return
end


!--------------------------------------------------------------------------
  subroutine int2dpdp(phmdint,exfac1,exfac2,xyziq,xzkl,rot,nijkl,nbfijkl)
!--------------------------------------------------------------------------
!
! Calculate (dp|dp) integrals
!
! In  : exfac12, exfac34 (exponents and coefficients of primitive pair functions)
!       xyziq    (x,y,z elements of i and q)
!       xzkl     (x,z elements of k and l)
!       nij, nkl (number of primitive pair functions)
! Out : phmdint  (two-electron integral)
!
      use fmtgrid, only : fgrid, threshtval
      implicit none
      integer,intent(in) :: nijkl(2), nbfijkl(4)
      integer :: ij, kl, igrid, i, j, k, l, ii
      real(8),parameter :: zero=0.0D+00, one=1.0D+00, sqrtpi4=0.8862269254527580D+00
      real(8),parameter :: half=0.5D+00, two=2.0D+00, three=3.0D+00, four=4.0D+00, five=5.0D+00
      real(8),parameter :: six=6.0D+00, seven=7.0D+00, eight=8.0D+00, nine=9.0D+00, ten=1.0D+01
      real(8),parameter :: p11=1.1D+01, p15=1.5D+01, p45=4.5D+01
      real(8),parameter :: sqrt3=1.73205080756888D+00, sqrt3h=8.660254037844386D-01
      real(8),intent(in) :: exfac1(5,*), exfac2(5,*)
      real(8),intent(in) :: xyziq(3,*), xzkl(2), rot(3,3)
      real(8),intent(out) :: phmdint(6,6,6,6)
      real(8) :: tval, tval2, tval3, tval4, tval5, tval6, tval7, tval8, tval9, tval10
      real(8) :: tinv, ft(0:6)
      real(8) :: f0(3), f1(2,8), f2(3,9), f3(4,9), f4(5,6), f5(6,3), f6(7), ftw(6,9)
      real(8) :: r0(9), r1(3,18), r2(6,21), r3(10,18), r4(15,10), r5(21,4), r6(28)
      real(8) :: ex12, ex34, ex43, ex14, ex41, expq, expq2, expq4, ex3q, ex4q, c12, c34, zip
      real(8) :: xiq, yiq, ziq, xiq2, yiq2, xyiq, xiq4, yiq4, xyiq2, xiq6, yiq6, x4y2, x2y4
      real(8) :: xypq2, zpq, zpq2, zpq3, zpq4, zpq5, fac, ex33q, ex34q, zjp
      real(8) :: pmd, pmd2, qmd, qmd2, qmd3, qmd3x, qmd3y, qmd3xy
      real(8) :: eri(6,3,6,3), work(8), f1w(3,6), f2w(6,8), f3w(10,9), f4w(15,6), f5w(21,3)
      real(8) :: rot2(6,6), rot3(6,5)
!
! Zero-clear
!
      r0(1:9)      = zero
      r1(1:3 ,1:18)= zero
      r2(1:6 ,1:21)= zero
      r3(1:10,1:18)= zero
      r4(1:15,1:10)= zero
      r5(1:21,1:4) = zero
      r6(1:28)     = zero
!
      do kl= 1,nijkl(2)
        ex34= exfac2(1,kl)
        ex43= exfac2(2,kl)
        ex3q= exfac2(3,kl)
        ex4q= exfac2(4,kl)
        c34 = exfac2(5,kl)
        xiq = xyziq(1,kl)
        yiq = xyziq(2,kl)
        ziq = xyziq(3,kl)
        xiq2= xiq*xiq
        yiq2= yiq*yiq
        xyiq= xiq*yiq
        xiq4= xiq2*xiq2
        yiq4= yiq2*yiq2
        xyiq2= xiq2*yiq2
        xiq6 = xiq4*xiq2
        yiq6 = yiq4*yiq2
        x4y2 = xiq4*yiq2
        x2y4 = xiq2*yiq4
        xypq2= xiq2+yiq2
        f0(1:3)    = zero
        f1(1:2,1:8)= zero
        f2(1:3,1:9)= zero
        f3(1:4,1:9)= zero
        f4(1:5,1:6)= zero
        f5(1:6,1:3)= zero
        f6(1:7)    = zero
        do ij= 1,nijkl(1)
          ex12= exfac1(1,ij)
          pmd = exfac1(2,ij)
          zjp = exfac1(3,ij)
          zip = exfac1(4,ij)
          c12 = exfac1(5,ij)
          ex14= ex12+ex34
          zpq = ziq-zip
          zpq2= zpq*zpq
          expq= ex12*ex34
          tval=(xypq2+zpq2)*expq
!
! Calculate Fm(T)
!
          if(tval >= threshtval*ex14) then
            tinv= one/sqrt(tval)
            ft(0)= c12*sqrtpi4*tinv
            expq= expq*tinv*tinv
            ft(1)= ft(0)*expq
            ft(2)= ft(1)*expq*three
            ft(3)= ft(2)*expq*five
            ft(4)= ft(3)*expq*seven
            ft(5)= ft(4)*expq*nine
            ft(6)= ft(5)*expq*p11
          else
            ex41= one/sqrt(ex14)
            tval= tval*ex41*ex41
            igrid= int(tval)
            tval2= tval *tval
            tval3= tval2*tval
            tval4= tval2*tval2
            tval5= tval2*tval3
            tval6= tval3*tval3
            tval7= tval4*tval3
            tval8= tval4*tval4
            tval9= tval4*tval5
            tval10=tval5*tval5
            do ii= 0,6
              ft(ii)= fgrid(0,ii,igrid)      +fgrid( 1,ii,igrid)*tval  +fgrid( 2,ii,igrid)*tval2 &
&                    +fgrid(3,ii,igrid)*tval3+fgrid( 4,ii,igrid)*tval4 +fgrid( 5,ii,igrid)*tval5 &
&                    +fgrid(6,ii,igrid)*tval6+fgrid( 7,ii,igrid)*tval7 +fgrid( 8,ii,igrid)*tval8 &
&                    +fgrid(9,ii,igrid)*tval9+fgrid(10,ii,igrid)*tval10
            enddo
            fac= c12*ex41
            expq= expq*two*ex41*ex41
            expq2= expq*expq
            expq4= expq2*expq2
            ft(0)= ft(0)*fac
            ft(1)= ft(1)*fac*expq
            ft(2)= ft(2)*fac*expq2
            ft(3)= ft(3)*fac*expq2*expq
            ft(4)= ft(4)*fac*expq4
            ft(5)= ft(5)*fac*expq4*expq
            ft(6)= ft(6)*fac*expq4*expq2
          endif
          zpq3= zpq2*zpq
          zpq4= zpq2*zpq2
          zpq5= zpq2*zpq2*zpq
          pmd2= pmd*pmd
          ftw(1,1)= zjp*zjp*zip
          ftw(1,2)= pmd*zjp
          ftw(1,3)= pmd*zip
          ftw(1,4)= pmd*zjp*zjp
          ftw(1,5)= pmd*zjp*zip
          ftw(1,6)= pmd2
          ftw(1,7)= pmd2*zjp
          ftw(1,8)= pmd2*zip
          ftw(1,9)= pmd2*pmd
          do i= 1,9
            ftw(2,i)= ftw(1,i)*zpq
            ftw(3,i)= ftw(1,i)*zpq2
            ftw(4,i)= ftw(1,i)*zpq3
            ftw(5,i)= ftw(1,i)*zpq4
            ftw(6,i)= ftw(1,i)*zpq5
          enddo
          f0(1)= f0(1)+ft(0)*ftw(1,1)
          f0(2)= f0(2)+ft(0)*ftw(1,2)
          f0(3)= f0(3)+ft(0)*ftw(1,3)
          do i= 1,6
            f1(1,i)= f1(1,i)-ft(1)*ftw(1,i)
            f1(2,i)= f1(2,i)-ft(1)*ftw(2,i)
          enddo
          f1(1,7)= f1(1,7)-ft(1)*ftw(1,7)
          f1(1,8)= f1(1,8)-ft(1)*ftw(1,8)
          do i= 1,9
            f2(1,i)= f2(1,i)+ft(2)*ftw(1,i)
            f2(2,i)= f2(2,i)+ft(2)*ftw(2,i)
            f2(3,i)= f2(3,i)+ft(2)*ftw(3,i)
          enddo
          do i= 1,9
            do j= 1,4
              f3(j,i)= f3(j,i)-ft(3)*ftw(j,i)
            enddo
          enddo
          do i= 1,6
            do j= 1,5
              f4(j,i)= f4(j,i)+ft(4)*ftw(j,i+3)
            enddo
          enddo
          do i= 1,3
            do j= 1,6
              f5(j,i)= f5(j,i)-ft(5)*ftw(j,i+6)
            enddo
          enddo
          f6(1)= f6(1)+ft(6)*ftw(1,9)
          f6(2)= f6(2)+ft(6)*ftw(2,9)
          f6(3)= f6(3)+ft(6)*ftw(3,9)
          f6(4)= f6(4)+ft(6)*ftw(4,9)
          f6(5)= f6(5)+ft(6)*ftw(5,9)
          f6(6)= f6(6)+ft(6)*ftw(6,9)
          f6(7)= f6(7)+ft(6)*ftw(6,9)*zpq
        enddo
!
        qmd = ex43*c34
        qmd2= qmd*ex43
        qmd3= qmd*ex43*ex43
        ex33q= ex3q*ex3q
        ex34q= ex3q*ex4q
        qmd3x= qmd3*xiq
        qmd3y= qmd3*yiq
        qmd3xy=qmd3*xiq*yiq
!
        work( 1)= qmd*ex3q
        work( 2)= qmd*ex4q
        work( 3)= ex33q*ex4q*c34
        work( 4)= qmd2
        work( 5)= qmd*ex33q
        work( 6)= qmd*ex34q
        work( 7)= qmd2*ex3q
        work( 8)= qmd2*ex4q
!
        do i= 1,3
          r0(i  )= r0(i  )+f0(1)*work(i)
          r0(i+3)= r0(i+3)+f0(2)*work(i)
          r0(i+6)= r0(i+6)+f0(3)*work(i)
        enddo
!
        do i= 1,6
          f1w(1,i)= f1(1,i)*xiq
          f1w(2,i)= f1(1,i)*yiq
          f1w(3,i)= f1(2,i)
        enddo
        do i= 1,3
          do j= 1,3
            r1(j,i  )= r1(j,i  )+f1w(j,1)*work(i+3)
            r1(j,i+3)= r1(j,i+3)+f1w(j,2)*work(i+3)
            r1(j,i+6)= r1(j,i+6)+f1w(j,3)*work(i+3)
          enddo
        enddo
        do i= 1,3
          do j= 1,3
            r1(j,i+ 9)= r1(j,i+ 9)+f1w(j,4)*work(i)
            r1(j,i+12)= r1(j,i+12)+f1w(j,5)*work(i)
            r1(j,i+15)= r1(j,i+15)+f1w(j,6)*work(i)
          enddo
        enddo
!
        do i= 1,8
          f2w(1,i)= f2(1,i)*xiq2+f1(1,i)
          f2w(2,i)= f2(1,i)*yiq2+f1(1,i)
          f2w(3,i)= f2(3,i)     +f1(1,i)
          f2w(4,i)= f2(1,i)*xyiq
          f2w(5,i)= f2(2,i)*xiq
          f2w(6,i)= f2(2,i)*yiq
        enddo
        do i= 1,2
          do j= 1,6
            r2(j,i  )= r2(j,i  )+f2w(j,1)*work(i+6)
            r2(j,i+2)= r2(j,i+2)+f2w(j,2)*work(i+6)
            r2(j,i+4)= r2(j,i+4)+f2w(j,3)*work(i+6)
          enddo
        enddo
        do i= 1,3
          do j= 1,6
            r2(j,i+ 6)= r2(j,i+ 6)+f2w(j,4)*work(i+3)
            r2(j,i+ 9)= r2(j,i+ 9)+f2w(j,5)*work(i+3)
            r2(j,i+12)= r2(j,i+12)+f2w(j,6)*work(i+3)
            r2(j,i+15)= r2(j,i+15)+f2w(j,7)*work(i)
            r2(j,i+18)= r2(j,i+18)+f2w(j,8)*work(i)
          enddo
        enddo
! 
        do i= 1,9
          f3w( 1,i)=(f3(1,i)*xiq2+f2(1,i)*three)*xiq
          f3w( 2,i)=(f3(1,i)*xiq2+f2(1,i)      )*yiq
          f3w( 3,i)=(f3(2,i)*xiq2+f2(2,i)      )
          f3w( 4,i)=(f3(1,i)*yiq2+f2(1,i)      )*xiq
          f3w( 5,i)=(f3(2,i)*xyiq              )
          f3w( 6,i)=(f3(3,i)     +f2(1,i)      )*xiq
          f3w( 7,i)=(f3(1,i)*yiq2+f2(1,i)*three)*yiq
          f3w( 8,i)=(f3(2,i)*yiq2+f2(2,i)      )
          f3w( 9,i)=(f3(3,i)     +f2(1,i)      )*yiq
          f3w(10,i)=(f3(4,i)     +f2(2,i)*three)
        enddo
        do j= 1,10
          r3(j,1)= r3(j,1)+f3w(j,1)*qmd3
          r3(j,2)= r3(j,2)+f3w(j,2)*qmd3
          r3(j,3)= r3(j,3)+f3w(j,3)*qmd3
        enddo
        do i= 1,2
          do j= 1,10
            r3(j,i+3)= r3(j,i+3)+f3w(j,4)*work(i+6)
            r3(j,i+5)= r3(j,i+5)+f3w(j,5)*work(i+6)
            r3(j,i+7)= r3(j,i+7)+f3w(j,6)*work(i+6)
          enddo
        enddo
        do i= 1,3
          do j= 1,10
            r3(j,i+ 9)= r3(j,i+ 9)+f3w(j,7)*work(i+3)
            r3(j,i+12)= r3(j,i+12)+f3w(j,8)*work(i+3)
            r3(j,i+15)= r3(j,i+15)+f3w(j,9)*work(i)
          enddo
        enddo
!
        do i= 1,6
          f4w( 1,i)=(f4(1,i)*xiq4 +f3(1,i+3)*xiq2*six           +f2(1,i+3)*three)
          f4w( 2,i)=(f4(1,i)*xiq2 +f3(1,i+3)*three                              )*xyiq
          f4w( 3,i)=(f4(2,i)*xiq2 +f3(2,i+3)*three                              )*xiq
          f4w( 4,i)=(f4(1,i)*xyiq2+f3(1,i+3)*xiq2+f3(1,i+3)*yiq2+f2(1,i+3)      )
          f4w( 5,i)=(f4(2,i)*xiq2 +f3(2,i+3)                                    )*yiq
          f4w( 6,i)=(f4(3,i)*xiq2 +f3(1,i+3)*xiq2+f3(3,i+3)     +f2(1,i+3)      )
          f4w( 7,i)=(f4(1,i)*yiq2 +f3(1,i+3)*three                              )*xyiq
          f4w( 8,i)=(f4(2,i)*yiq2 +f3(2,i+3)                                    )*xiq
          f4w( 9,i)=(f4(3,i)      +f3(1,i+3)                                    )*xyiq
          f4w(10,i)=(f4(4,i)      +f3(2,i+3)*three                              )*xiq
          f4w(11,i)=(f4(1,i)*yiq4 +f3(1,i+3)*yiq2*six           +f2(1,i+3)*three)
          f4w(12,i)=(f4(2,i)*yiq2 +f3(2,i+3)*three                              )*yiq
          f4w(13,i)=(f4(3,i)*yiq2 +f3(1,i+3)*yiq2+f3(3,i+3)     +f2(1,i+3)      )
          f4w(14,i)=(f4(4,i)      +f3(2,i+3)*three                              )*yiq
          f4w(15,i)=(f4(5,i)      +f3(3,i+3)*six                +f2(1,i+3)*three)
        enddo
        do j= 1,15
          r4(j,1)= r4(j,1)+f4w(j,1)*qmd3
          r4(j,2)= r4(j,2)+f4w(j,2)*qmd3
          r4(j,3)= r4(j,3)+f4w(j,3)*qmd3
        enddo
        do i= 1,2
          do j= 1,15
            r4(j,i+3)= r4(j,i+3)+f4w(j,4)*work(i+6)
            r4(j,i+5)= r4(j,i+5)+f4w(j,5)*work(i+6)
          enddo
        enddo
        do i= 8,10
          do j= 1,15
            r4(j,i)= r4(j,i)+f4w(j,6)*work(i-4)
          enddo
        enddo
!
        do i= 1,3
          f5w( 1,i)=(f5(1,i)*xiq4 +f4(1,i+3)*xiq2*ten                 +f3(1,i+6)*p15  )*xiq
          f5w( 2,i)=(f5(1,i)*xiq4 +f4(1,i+3)*xiq2*six                 +f3(1,i+6)*three)*yiq
          f5w( 3,i)=(f5(2,i)*xiq4 +f4(2,i+3)*xiq2*six                 +f3(2,i+6)*three)
          f5w( 4,i)=(f5(1,i)*xyiq2+f4(1,i+3)*xiq2+f4(1,i+3)*yiq2*three+f3(1,i+6)*three)*xiq
          f5w( 5,i)=(f5(2,i)*xiq2 +f4(2,i+3)*three                                    )*xyiq
          f5w( 6,i)=(f5(3,i)*xiq2 +f4(1,i+3)*xiq2+f4(3,i+3)*three     +f3(1,i+6)*three)*xiq
          f5w( 7,i)=(f5(1,i)*xyiq2+f4(1,i+3)*xiq2*three+f4(1,i+3)*yiq2+f3(1,i+6)*three)*yiq
          f5w( 8,i)=(f5(2,i)*xyiq2+f4(2,i+3)*xiq2+f4(2,i+3)*yiq2      +f3(2,i+6)      )
          f5w( 9,i)=(f5(3,i)*xiq2 +f4(1,i+3)*xiq2+f4(3,i+3)           +f3(1,i+6)      )*yiq
          f5w(10,i)=(f5(4,i)*xiq2 +f4(2,i+3)*xiq2*three+f4(4,i+3)     +f3(2,i+6)*three)
          f5w(11,i)=(f5(1,i)*yiq4 +f4(1,i+3)*yiq2*six                 +f3(1,i+6)*three)*xiq
          f5w(12,i)=(f5(2,i)*yiq2 +f4(2,i+3)*three                                    )*xyiq
          f5w(13,i)=(f5(3,i)*yiq2 +f4(1,i+3)*yiq2+f4(3,i+3)           +f3(1,i+6)      )*xiq
          f5w(14,i)=(f5(4,i)      +f4(2,i+3)*three                                    )*xyiq
          f5w(15,i)=(f5(5,i)      +f4(3,i+3)*six                      +f3(1,i+6)*three)*xiq
          f5w(16,i)=(f5(1,i)*yiq4 +f4(1,i+3)*yiq2*ten                 +f3(1,i+6)*p15  )*yiq
          f5w(17,i)=(f5(2,i)*yiq4 +f4(2,i+3)*yiq2*six                 +f3(2,i+6)*three)
          f5w(18,i)=(f5(3,i)*yiq2 +f4(1,i+3)*yiq2+f4(3,i+3)*three     +f3(1,i+6)*three)*yiq
          f5w(19,i)=(f5(4,i)*yiq2 +f4(2,i+3)*yiq2*three+f4(4,i+3)     +f3(2,i+6)*three)
          f5w(20,i)=(f5(5,i)      +f4(3,i+3)*six                      +f3(1,i+6)*three)*yiq
          f5w(21,i)=(f5(6,i)      +f4(4,i+3)*ten                      +f3(2,i+6)*p15  )
        enddo
        do j= 1,21
          r5(j,1)= r5(j,1)+f5w(j,1)*qmd3
          r5(j,2)= r5(j,2)+f5w(j,2)*qmd3
          r5(j,3)= r5(j,3)+f5w(j,3)*work(7)
          r5(j,4)= r5(j,4)+f5w(j,3)*work(8)
        enddo
!
        r6( 1)= r6( 1)+(f6(1)*xiq6+f5(1,3)*xiq4*p15+f4(1,6)*xiq2*p45+f3(1,9)*p15)*qmd3
        r6( 2)= r6( 2)+(f6(1)*xiq4+f5(1,3)*xiq2*ten+f4(1,6)*p15)*qmd3xy
        r6( 3)= r6( 3)+(f6(2)*xiq4+f5(2,3)*xiq2*ten+f4(2,6)*p15)*qmd3x
        r6( 4)= r6( 4)+(f6(1)*x4y2+f5(1,3)*xiq4+f5(1,3)*xyiq2*six+f4(1,6)*xiq2*six &
&                      +f4(1,6)*yiq2*three+f3(1,9)*three)*qmd3
        r6( 5)= r6( 5)+(f6(2)*xiq4+f5(2,3)*xiq2*six+f4(2,6)*three)*qmd3y
        r6( 6)= r6( 6)+(f6(3)*xiq4+f5(1,3)*xiq4+f5(3,3)*xiq2*six+f4(1,6)*xiq2*six &
&                      +f4(3,6)*three+f3(1,9)*three)*qmd3
        r6( 7)= r6( 7)+(f6(1)*xyiq2+f5(1,3)*xiq2*three+f5(1,3)*yiq2*three+f4(1,6)*nine)*qmd3xy
        r6( 8)= r6( 8)+(f6(2)*xyiq2+f5(2,3)*xiq2+f5(2,3)*yiq2*three+f4(2,6)*three)*qmd3x
        r6( 9)= r6( 9)+(f6(3)*xiq2+f5(1,3)*xiq2+f5(3,3)*three+f4(1,6)*three)*qmd3xy
        r6(10)= r6(10)+(f6(4)*xiq2+f5(2,3)*xiq2*three+f5(4,3)*three+f4(2,6)*nine)*qmd3x
        r6(11)= r6(11)+(f6(1)*x2y4+f5(1,3)*xyiq2*six+f5(1,3)*yiq4+f4(1,6)*xiq2*three &
&                      +f4(1,6)*yiq2*six+f3(1,9)*three)*qmd3
        r6(12)= r6(12)+(f6(2)*xyiq2+f5(2,3)*xiq2*three+f5(2,3)*yiq2+f4(2,6)*three)*qmd3y
        r6(13)= r6(13)+(f6(3)*xyiq2+f5(1,3)*xyiq2+f5(3,3)*xiq2+f5(3,3)*yiq2+f4(1,6)*xiq2 &
&                      +f4(1,6)*yiq2+f4(3,6)+f3(1,9))*qmd3
        r6(14)= r6(14)+(f6(4)*xiq2+f5(2,3)*xiq2*three+f5(4,3)+f4(2,6)*three)*qmd3y
        r6(15)= r6(15)+(f6(5)*xiq2+f5(3,3)*xiq2*six+f5(5,3)+f4(1,6)*xiq2*three+f4(3,6)*six &
&                      +f3(1,9)*three)*qmd3
        r6(16)= r6(16)+(f6(1)*yiq4+f5(1,3)*yiq2*ten+f4(1,6)*p15)*qmd3xy
        r6(17)= r6(17)+(f6(2)*yiq4+f5(2,3)*yiq2*six+f4(2,6)*three)*qmd3x
        r6(18)= r6(18)+(f6(3)*yiq2+f5(1,3)*yiq2+f5(3,3)*three+f4(1,6)*three)*qmd3xy
        r6(19)= r6(19)+(f6(4)*yiq2+f5(2,3)*yiq2*three+f5(4,3)+f4(2,6)*three)*qmd3x
        r6(20)= r6(20)+(f6(5)+f5(3,3)*six+f4(1,6)*three)*qmd3xy
        r6(21)= r6(21)+(f6(6)+f5(4,3)*ten+f4(2,6)*p15)*qmd3x
        r6(22)= r6(22)+(f6(1)*yiq6+f5(1,3)*yiq4*p15+f4(1,6)*yiq2*p45+f3(1,9)*p15)*qmd3
        r6(23)= r6(23)+(f6(2)*yiq4+f5(2,3)*yiq2*ten+f4(2,6)*p15)*qmd3y
        r6(24)= r6(24)+(f6(3)*yiq4+f5(1,3)*yiq4+f5(3,3)*yiq2*six+f4(1,6)*yiq2*six &
&                      +f4(3,6)*three+f3(1,9)*three)*qmd3
        r6(25)= r6(25)+(f6(4)*yiq2+f5(2,3)*yiq2*three+f5(4,3)*three+f4(2,6)*nine)*qmd3y
        r6(26)= r6(26)+(f6(5)*yiq2+f5(3,3)*yiq2*six+f5(5,3)+f4(1,6)*yiq2*three+f4(3,6)*six &
&                      +f3(1,9)*three)*qmd3
        r6(27)= r6(27)+(f6(6)+f5(4,3)*ten+f4(2,6)*p15)*qmd3y
        r6(28)= r6(28)+(f6(7)+f5(5,3)*p15+f4(3,6)*p45+f3(1,9)*p15)*qmd3
      enddo
!
      call int2dpdp1(eri,r0,r1,r2,r3,r4,r5,r6,xzkl(1),xzkl(2))
!
      rot2(1,1)= rot(1,1)*rot(1,1)
      rot2(2,1)= rot(2,1)*rot(2,1)
      rot2(3,1)= rot(3,1)*rot(3,1)
      rot2(4,1)= rot(1,1)*rot(2,1)*two
      rot2(5,1)= rot(1,1)*rot(3,1)*two
      rot2(6,1)= rot(2,1)*rot(3,1)*two
      do l= 2,3
        rot2(1,l)= rot(1,1)*rot(1,l)*sqrt3
        rot2(2,l)= rot(2,1)*rot(2,l)*sqrt3
        rot2(3,l)= rot(3,1)*rot(3,l)*sqrt3
        rot2(4,l)=(rot(1,1)*rot(2,l)+rot(2,1)*rot(1,l))*sqrt3
        rot2(5,l)=(rot(1,1)*rot(3,l)+rot(3,1)*rot(1,l))*sqrt3
        rot2(6,l)=(rot(2,1)*rot(3,l)+rot(3,1)*rot(2,l))*sqrt3
      enddo
      do l= 2,3
        rot2(1,l*2)= rot(1,l)*rot(1,l)
        rot2(2,l*2)= rot(2,l)*rot(2,l)
        rot2(3,l*2)= rot(3,l)*rot(3,l)
        rot2(4,l*2)= rot(1,l)*rot(2,l)*two
        rot2(5,l*2)= rot(1,l)*rot(3,l)*two
        rot2(6,l*2)= rot(2,l)*rot(3,l)*two
      enddo
      rot2(1,5)= rot(1,2)*rot(1,3)*sqrt3
      rot2(2,5)= rot(2,2)*rot(2,3)*sqrt3
      rot2(3,5)= rot(3,2)*rot(3,3)*sqrt3
      rot2(4,5)=(rot(1,2)*rot(2,3)+rot(2,2)*rot(1,3))*sqrt3
      rot2(5,5)=(rot(1,2)*rot(3,3)+rot(3,2)*rot(1,3))*sqrt3
      rot2(6,5)=(rot(2,2)*rot(3,3)+rot(3,2)*rot(2,3))*sqrt3
!
      do l= 1,6
        rot3(l,1)= rot2(l,2)
        rot3(l,2)= rot2(l,5)
        rot3(l,3)= rot2(l,6)-(rot2(l,1)+rot2(l,4))*half
        rot3(l,4)= rot2(l,3)
        rot3(l,5)=(rot2(l,1)-rot2(l,4))*sqrt3h
      enddo
!
      do j= 1,6
        do k= 1,3
          do l= 1,6
            work(1)= eri(l,k,j,1)
            work(2)= eri(l,k,j,2)
            work(3)= eri(l,k,j,3)
            eri(l,k,j,1)= work(1)*rot(1,1)+work(2)*rot(2,1)+work(3)*rot(3,1)
            eri(l,k,j,2)= work(1)*rot(1,2)+work(2)*rot(2,2)+work(3)*rot(3,2)
            eri(l,k,j,3)= work(1)*rot(1,3)+work(2)*rot(2,3)+work(3)*rot(3,3)
          enddo
        enddo
      enddo
!
      if(nbfijkl(2) == 6)then
        do i= 1,3
          do k= 1,3
            do l= 1,6
              do j= 1,6
                work(j)= eri(l,k,j,i)
              enddo
              do j= 1,6
                eri(l,k,j,i)= work(1)*rot2(1,j)+work(2)*rot2(2,j)+work(3)*rot2(3,j) &
&                            +work(4)*rot2(4,j)+work(5)*rot2(5,j)+work(6)*rot2(6,j)
              enddo
            enddo
          enddo
        enddo
      else
        do i= 1,3
          do k= 1,3
            do l= 1,6
              do j= 1,6
                work(j)= eri(l,k,j,i)
              enddo
              do j= 1,5
                eri(l,k,j,i)= work(1)*rot3(1,j)+work(2)*rot3(2,j)+work(3)*rot3(3,j) &
&                            +work(4)*rot3(4,j)+work(5)*rot3(5,j)+work(6)*rot3(6,j)
              enddo
            enddo
          enddo
        enddo
      endif
!
      do i= 1,3
        do j= 1,nbfijkl(2)
          do l= 1,6
            work(1)= eri(l,1,j,i)
            work(2)= eri(l,2,j,i)
            work(3)= eri(l,3,j,i)
            eri(l,1,j,i)= work(1)*rot(1,1)+work(2)*rot(2,1)+work(3)*rot(3,1)
            eri(l,2,j,i)= work(1)*rot(1,2)+work(2)*rot(2,2)+work(3)*rot(3,2)
            eri(l,3,j,i)= work(1)*rot(1,3)+work(2)*rot(2,3)+work(3)*rot(3,3)
          enddo
        enddo
      enddo
!
      if(nbfijkl(4) == 6)then
        do i= 1,3
          do j= 1,nbfijkl(2)
            do k= 1,3
              do l= 1,6
                phmdint(l,k,j,i)= &
&                   eri(1,k,j,i)*rot2(1,l)+eri(2,k,j,i)*rot2(2,l)+eri(3,k,j,i)*rot2(3,l) &
&                  +eri(4,k,j,i)*rot2(4,l)+eri(5,k,j,i)*rot2(5,l)+eri(6,k,j,i)*rot2(6,l) 
              enddo
            enddo
          enddo
        enddo
      else
        do i= 1,3
          do j= 1,nbfijkl(2)
            do k= 1,3
              do l= 1,5
                phmdint(l,k,j,i)= &
&                   eri(1,k,j,i)*rot3(1,l)+eri(2,k,j,i)*rot3(2,l)+eri(3,k,j,i)*rot3(3,l) &
&                  +eri(4,k,j,i)*rot3(4,l)+eri(5,k,j,i)*rot3(5,l)+eri(6,k,j,i)*rot3(6,l)
              enddo
            enddo
          enddo
        enddo
      endif
!
      return
end


!-------------------------------------------------------
  subroutine int2dpdp1(eri,r0,r1,r2,r3,r4,r5,r6,qx,qz)
!-------------------------------------------------------
      implicit none
      integer :: i, j, k, l, ijcycle
      real(8),parameter :: two=2.0D+00, three=3.0D+00, four=4.0D+00, six=6.0D+00, nine=9.0D+00
      real(8),intent(in) :: r0(9), r1(3,18), r2(6,21), r3(10,18), r4(15,10), r5(21,4), r6(28)
      real(8),intent(in) :: qx, qz
      real(8),intent(out) :: eri(6,3,6,3)
      real(8) :: rrr(10), rxyz(19), xx, xz, zz, xxx, xxz, xzz, zzz
!
      xx= qx*qx
      xz= qx*qz
      zz= qz*qz
      xxx= qx*qx*qx
      xxz= qx*qx*qz
      xzz= qx*qz*qz
      zzz= qz*qz*qz
      ijcycle= 0
      do i= 1,3
        do j= 1,6
          ijcycle= ijcycle+1
          select case(ijcycle)
            case(1)
              rrr( 1)=-r6(1)-r4(1,3)*three-r4(1,8)*three-r2(1,13)*nine
              rrr( 2)=-r6(2)-r4(2,3)*three-r4(2,8)-r2(4,13)*three
              rrr( 3)=-r6(3)-r4(3,3)*three-r4(3,8)-r2(5,13)*three
              rrr( 4)=-r6(4)-r4(4,3)*three-r4(1,8)-r2(1,13)*three
              rrr( 5)=-r6(5)-r4(5,3)*three
              rrr( 6)=-r6(6)-r4(6,3)*three-r4(1,8)-r2(1,13)*three
              rrr( 7)=-r6(7)-r4(7,3)*three-r4(2,8)*three-r2(4,13)*nine
              rrr( 8)=-r6(8)-r4(8,3)*three-r4(3,8)-r2(5,13)*three
              rrr( 9)=-r6(9)-r4(9,3)*three-r4(2,8)-r2(4,13)*three
              rrr(10)=-r6(10)-r4(10,3)*three-r4(3,8)*three-r2(5,13)*nine
              rxyz( 1)=-r5(1,3)-r3(1,8)*three-r3(1,16)-r1(1,16)*three
              rxyz( 2)=-r5(1,4)-r3(1,9)*three-r3(1,17)-r1(1,17)*three
              rxyz( 3)=-r4(1,9)-r2(1,14)*three
              rxyz( 4)=-r4(1,10)-r2(1,15)*three
              rxyz( 5)=-r3(1,18)-r1(1,18)*three
              rxyz( 6)=-r5(4,4)-r3(4,9)*three-r3(1,17)-r1(1,17)*three
              rxyz( 7)=-r5(6,3)-r3(6,8)*three-r3(1,16)-r1(1,16)*three
              rxyz( 8)=-r5(6,4)-r3(6,9)*three-r3(1,17)-r1(1,17)*three
              rxyz( 9)=-r5(3,3)-r3(3,8)*three
              rxyz(10)=-r5(3,4)-r3(3,9)*three
              rxyz(11)=-r4(3,9)-r2(5,14)*three
              rxyz(12)=-r4(3,10)-r2(5,15)*three
              rxyz(13)=-r5(2,3)-r3(2,8)*three
              rxyz(14)=-r5(2,4)-r3(2,9)*three
              rxyz(15)=-r5(5,3)-r3(5,8)*three
              rxyz(16)=-r5(5,4)-r3(5,9)*three
              rxyz(17)=-r4(2,9)-r2(4,14)*three
              rxyz(18)=-r4(2,10)-r2(4,15)*three
              rxyz(19)=-r5(4,3)-r3(4,8)*three-r3(1,16)-r1(1,16)*three
            case(2)
              rrr( 1)=-r6(4)-r4(1,3)-r4(4,8)*three-r2(1,13)*three
              rrr( 2)=-r6(7)-r4(2,3)-r4(7,8)-r2(4,13)
              rrr( 3)=-r6(8)-r4(3,3)-r4(8,8)-r2(5,13)
              rrr( 4)=-r6(11)-r4(4,3)-r4(4,8)-r2(1,13)
              rrr( 5)=-r6(12)-r4(5,3)
              rrr( 6)=-r6(13)-r4(6,3)-r4(4,8)-r2(1,13)
              rrr( 7)=-r6(16)-r4(7,3)-r4(7,8)*three-r2(4,13)*three
              rrr( 8)=-r6(17)-r4(8,3)-r4(8,8)-r2(5,13)
              rrr( 9)=-r6(18)-r4(9,3)-r4(7,8)-r2(4,13)
              rrr(10)=-r6(19)-r4(10,3)-r4(8,8)*three-r2(5,13)*three
              rxyz( 1)=-r5(4,3)-r3(1,8)-r3(4,16)-r1(1,16)
              rxyz( 2)=-r5(4,4)-r3(1,9)-r3(4,17)-r1(1,17)
              rxyz( 3)=-r4(4,9)-r2(1,14)
              rxyz( 4)=-r4(4,10)-r2(1,15)
              rxyz( 5)=-r3(4,18)-r1(1,18)
              rxyz( 6)=-r5(11,4)-r3(4,9)-r3(4,17)-r1(1,17)
              rxyz( 7)=-r5(13,3)-r3(6,8)-r3(4,16)-r1(1,16)
              rxyz( 8)=-r5(13,4)-r3(6,9)-r3(4,17)-r1(1,17)
              rxyz( 9)=-r5(8,3)-r3(3,8)
              rxyz(10)=-r5(8,4)-r3(3,9)
              rxyz(11)=-r4(8,9)-r2(5,14)
              rxyz(12)=-r4(8,10)-r2(5,15)
              rxyz(13)=-r5(7,3)-r3(2,8)
              rxyz(14)=-r5(7,4)-r3(2,9)
              rxyz(15)=-r5(12,3)-r3(5,8)
              rxyz(16)=-r5(12,4)-r3(5,9)
              rxyz(17)=-r4(7,9)-r2(4,14)
              rxyz(18)=-r4(7,10)-r2(4,15)
              rxyz(19)=-r5(11,3)-r3(4,8)-r3(4,16)-r1(1,16)
            case(3)
              rrr( 1)=-r6(6)+r5(3,1)*two-r4(1,1)-r4(1,3)-r4(6,8)*three+r3(3,10)*six &
&                     -r2(1,7)*three-r2(1,13)*three
              rrr( 2)=-r6(9)+r5(5,1)*two-r4(2,1)-r4(2,3)-r4(9,8)+r3(5,10)*two-r2(4,7)-r2(4,13)
              rrr( 3)=-r6(10)+r5(6,1)*two-r4(3,1)-r4(3,3)-r4(10,8)+r3(6,10)*two-r2(5,7)-r2(5,13)
              rrr( 4)=-r6(13)+r5(8,1)*two-r4(4,1)-r4(4,3)-r4(6,8)+r3(3,10)*two-r2(1,7)-r2(1,13)
              rrr( 5)=-r6(14)+r5(9,1)*two-r4(5,1)-r4(5,3)
              rrr( 6)=-r6(15)+r5(10,1)*two-r4(6,1)-r4(6,3)-r4(6,8)+r3(3,10)*two-r2(1,7)-r2(1,13)
              rrr( 7)=-r6(18)+r5(12,1)*two-r4(7,1)-r4(7,3)-r4(9,8)*three+r3(5,10)*six &
&                     -r2(4,7)*three-r2(4,13)*three
              rrr( 8)=-r6(19)+r5(13,1)*two-r4(8,1)-r4(8,3)-r4(10,8)+r3(6,10)*two-r2(5,7)-r2(5,13)
              rrr( 9)=-r6(20)+r5(14,1)*two-r4(9,1)-r4(9,3)-r4(9,8)+r3(5,10)*two-r2(4,7)-r2(4,13)
              rrr(10)=-r6(21)+r5(15,1)*two-r4(10,1)-r4(10,3)-r4(10,8)*three+r3(6,10)*six &
&                     -r2(5,7)*three-r2(5,13)*three
              rxyz( 1)=-r5(6,3)+r4(3,4)*two-r3(1,4)-r3(1,8)-r3(6,16)+r2(5,16)*two-r1(1,10)-r1(1,16)
              rxyz( 2)=-r5(6,4)+r4(3,5)*two-r3(1,5)-r3(1,9)-r3(6,17)+r2(5,17)*two-r1(1,11)-r1(1,17)
              rxyz( 3)=-r4(6,9)+r3(3,11)*two-r2(1,8)-r2(1,14)
              rxyz( 4)=-r4(6,10)+r3(3,12)*two-r2(1,9)-r2(1,15)
              rxyz( 5)=-r3(6,18)+r2(5,18)*two-r1(1,12)-r1(1,18)
              rxyz( 6)=-r5(13,4)+r4(8,5)*two-r3(4,5)-r3(4,9)-r3(6,17)+r2(5,17)*two-r1(1,11) &
&                      -r1(1,17)
              rxyz( 7)=-r5(15,3)+r4(10,4)*two-r3(6,4)-r3(6,8)-r3(6,16)+r2(5,16)*two-r1(1,10) &
&                      -r1(1,16)
              rxyz( 8)=-r5(15,4)+r4(10,5)*two-r3(6,5)-r3(6,9)-r3(6,17)+r2(5,17)*two-r1(1,11) &
&                      -r1(1,17)
              rxyz( 9)=-r5(10,3)+r4(6,4)*two-r3(3,4)-r3(3,8)
              rxyz(10)=-r5(10,4)+r4(6,5)*two-r3(3,5)-r3(3,9)
              rxyz(11)=-r4(10,9)+r3(6,11)*two-r2(5,8)-r2(5,14)
              rxyz(12)=-r4(10,10)+r3(6,12)*two-r2(5,9)-r2(5,15)
              rxyz(13)=-r5(9,3)+r4(5,4)*two-r3(2,4)-r3(2,8)
              rxyz(14)=-r5(9,4)+r4(5,5)*two-r3(2,5)-r3(2,9)
              rxyz(15)=-r5(14,3)+r4(9,4)*two-r3(5,4)-r3(5,8)
              rxyz(16)=-r5(14,4)+r4(9,5)*two-r3(5,5)-r3(5,9)
              rxyz(17)=-r4(9,9)+r3(5,11)*two-r2(4,8)-r2(4,14)
              rxyz(18)=-r4(9,10)+r3(5,12)*two-r2(4,9)-r2(4,15)
              rxyz(19)=-r5(13,3)+r4(8,4)*two-r3(4,4)-r3(4,8)-r3(6,16)+r2(5,16)*two-r1(1,10) &
&                      -r1(1,16)
            case(4)
              rrr( 1)=-r6(2)-r4(2,3)-r4(2,8)*three-r2(4,13)*three
              rrr( 2)=-r6(4)-r4(4,3)-r4(4,8)-r2(2,13)
              rrr( 3)=-r6(5)-r4(5,3)-r4(5,8)-r2(6,13)
              rrr( 4)=-r6(7)-r4(7,3)-r4(2,8)-r2(4,13)
              rrr( 5)=-r6(8)-r4(8,3)
              rrr( 6)=-r6(9)-r4(9,3)-r4(2,8)-r2(4,13)
              rrr( 7)=-r6(11)-r4(11,3)-r4(4,8)*three-r2(2,13)*three
              rrr( 8)=-r6(12)-r4(12,3)-r4(5,8)-r2(6,13)
              rrr( 9)=-r6(13)-r4(13,3)-r4(4,8)-r2(2,13)
              rrr(10)=-r6(14)-r4(14,3)-r4(5,8)*three-r2(6,13)*three
              rxyz( 1)=-r5(2,3)-r3(2,8)-r3(2,16)-r1(2,16)
              rxyz( 2)=-r5(2,4)-r3(2,9)-r3(2,17)-r1(2,17)
              rxyz( 3)=-r4(2,9)-r2(4,14)
              rxyz( 4)=-r4(2,10)-r2(4,15)
              rxyz( 5)=-r3(2,18)-r1(2,18)
              rxyz( 6)=-r5(7,4)-r3(7,9)-r3(2,17)-r1(2,17)
              rxyz( 7)=-r5(9,3)-r3(9,8)-r3(2,16)-r1(2,16)
              rxyz( 8)=-r5(9,4)-r3(9,9)-r3(2,17)-r1(2,17)
              rxyz( 9)=-r5(5,3)-r3(5,8)
              rxyz(10)=-r5(5,4)-r3(5,9)
              rxyz(11)=-r4(5,9)-r2(6,14)
              rxyz(12)=-r4(5,10)-r2(6,15)
              rxyz(13)=-r5(4,3)-r3(4,8)
              rxyz(14)=-r5(4,4)-r3(4,9)
              rxyz(15)=-r5(8,3)-r3(8,8)
              rxyz(16)=-r5(8,4)-r3(8,9)
              rxyz(17)=-r4(4,9)-r2(2,14)
              rxyz(18)=-r4(4,10)-r2(2,15)
              rxyz(19)=-r5(7,3)-r3(7,8)-r3(2,16)-r1(2,16)
            case(5)
              rrr( 1)=-r6(3)+r5(1,1)-r4(3,3)-r4(3,8)*three+r3(1,2)+r3(1,10)*three &
&                     -r2(5,13)*three+r1(1,4)*three
              rrr( 2)=-r6(5)+r5(2,1)-r4(5,3)-r4(5,8)+r3(2,2)+r3(2,10)-r2(6,13)+r1(2,4)
              rrr( 3)=-r6(6)+r5(3,1)-r4(6,3)-r4(6,8)+r3(3,2)+r3(3,10)-r2(3,13)+r1(3,4)
              rrr( 4)=-r6(8)+r5(4,1)-r4(8,3)-r4(3,8)+r3(4,2)+r3(1,10)-r2(5,13)+r1(1,4)
              rrr( 5)=-r6(9)+r5(5,1)-r4(9,3)+r3(5,2)
              rrr( 6)=-r6(10)+r5(6,1)-r4(10,3)-r4(3,8)+r3(6,2)+r3(1,10)-r2(5,13)+r1(1,4)
              rrr( 7)=-r6(12)+r5(7,1)-r4(12,3)-r4(5,8)*three+r3(7,2)+r3(2,10)*three &
&                     -r2(6,13)*three+r1(2,4)*three
              rrr( 8)=-r6(13)+r5(8,1)-r4(13,3)-r4(6,8)+r3(8,2)+r3(3,10)-r2(3,13)+r1(3,4)
              rrr( 9)=-r6(14)+r5(9,1)-r4(14,3)-r4(5,8)+r3(9,2)+r3(2,10)-r2(6,13)+r1(2,4)
              rrr(10)=-r6(15)+r5(10,1)-r4(15,3)-r4(6,8)*three+r3(10,2)+r3(3,10)*three &
&                     -r2(3,13)*three+r1(3,4)*three
              rxyz( 1)=-r5(3,3)+r4(1,4)-r3(3,8)-r3(3,16)+r2(1,3)+r2(1,16)-r1(3,16)+r0(4)
              rxyz( 2)=-r5(3,4)+r4(1,5)-r3(3,9)-r3(3,17)+r2(1,4)+r2(1,17)-r1(3,17)+r0(5)
              rxyz( 3)=-r4(3,9)+r3(1,11)-r2(5,14)+r1(1,5)
              rxyz( 4)=-r4(3,10)+r3(1,12)-r2(5,15)+r1(1,6)
              rxyz( 5)=-r3(3,18)+r2(1,18)-r1(3,18)+r0(6)
              rxyz( 6)=-r5(8,4)+r4(4,5)-r3(8,9)-r3(3,17)+r2(2,4)+r2(1,17)-r1(3,17)+r0(5)
              rxyz( 7)=-r5(10,3)+r4(6,4)-r3(10,8)-r3(3,16)+r2(3,3)+r2(1,16)-r1(3,16)+r0(4)
              rxyz( 8)=-r5(10,4)+r4(6,5)-r3(10,9)-r3(3,17)+r2(3,4)+r2(1,17)-r1(3,17)+r0(5)
              rxyz( 9)=-r5(6,3)+r4(3,4)-r3(6,8)+r2(5,3)
              rxyz(10)=-r5(6,4)+r4(3,5)-r3(6,9)+r2(5,4)
              rxyz(11)=-r4(6,9)+r3(3,11)-r2(3,14)+r1(3,5)
              rxyz(12)=-r4(6,10)+r3(3,12)-r2(3,15)+r1(3,6)
              rxyz(13)=-r5(5,3)+r4(2,4)-r3(5,8)+r2(4,3)
              rxyz(14)=-r5(5,4)+r4(2,5)-r3(5,9)+r2(4,4)
              rxyz(15)=-r5(9,3)+r4(5,4)-r3(9,8)+r2(6,3)
              rxyz(16)=-r5(9,4)+r4(5,5)-r3(9,9)+r2(6,4)
              rxyz(17)=-r4(5,9)+r3(2,11)-r2(6,14)+r1(2,5)
              rxyz(18)=-r4(5,10)+r3(2,12)-r2(6,15)+r1(2,6)
              rxyz(19)=-r5(8,3)+r4(4,4)-r3(8,8)-r3(3,16)+r2(2,3)+r2(1,16)-r1(3,16)+r0(4)
            case(6)
              rrr( 1)=-r6(5)+r5(2,1)-r4(5,8)*three+r3(2,10)*three
              rrr( 2)=-r6(8)+r5(4,1)-r4(8,8)+r3(4,10)
              rrr( 3)=-r6(9)+r5(5,1)-r4(9,8)+r3(5,10)
              rrr( 4)=-r6(12)+r5(7,1)-r4(5,8)+r3(2,10)
              rrr( 5)=-r6(13)+r5(8,1)
              rrr( 6)=-r6(14)+r5(9,1)-r4(5,8)+r3(2,10)
              rrr( 7)=-r6(17)+r5(11,1)-r4(8,8)*three+r3(4,10)*three
              rrr( 8)=-r6(18)+r5(12,1)-r4(9,8)+r3(5,10)
              rrr( 9)=-r6(19)+r5(13,1)-r4(8,8)+r3(4,10)
              rrr(10)=-r6(20)+r5(14,1)-r4(9,8)*three+r3(5,10)*three
              rxyz( 1)=-r5(5,3)+r4(2,4)-r3(5,16)+r2(4,16)
              rxyz( 2)=-r5(5,4)+r4(2,5)-r3(5,17)+r2(4,17)
              rxyz( 3)=-r4(5,9)+r3(2,11)
              rxyz( 4)=-r4(5,10)+r3(2,12)
              rxyz( 5)=-r3(5,18)+r2(4,18)
              rxyz( 6)=-r5(12,4)+r4(7,5)-r3(5,17)+r2(4,17)
              rxyz( 7)=-r5(14,3)+r4(9,4)-r3(5,16)+r2(4,16)
              rxyz( 8)=-r5(14,4)+r4(9,5)-r3(5,17)+r2(4,17)
              rxyz( 9)=-r5(9,3)+r4(5,4)
              rxyz(10)=-r5(9,4)+r4(5,5)
              rxyz(11)=-r4(9,9)+r3(5,11)
              rxyz(12)=-r4(9,10)+r3(5,12)
              rxyz(13)=-r5(8,3)+r4(4,4)
              rxyz(14)=-r5(8,4)+r4(4,5)
              rxyz(15)=-r5(13,3)+r4(8,4)
              rxyz(16)=-r5(13,4)+r4(8,5)
              rxyz(17)=-r4(8,9)+r3(4,11)
              rxyz(18)=-r4(8,10)+r3(4,12)
              rxyz(19)=-r5(12,3)+r4(7,4)-r3(5,16)+r2(4,16)
            case(7)
              do k= 1,3
                do l= 1,6
                  eri(l,k,1,2)= eri(l,k,4,1)
                enddo
              enddo
              cycle
            case(8)
              rrr( 1)=-r6(7)-r4(2,3)*three-r4(7,8)*three-r2(4,13)*nine
              rrr( 2)=-r6(11)-r4(4,3)*three-r4(11,8)-r2(2,13)*three
              rrr( 3)=-r6(12)-r4(5,3)*three-r4(12,8)-r2(6,13)*three
              rrr( 4)=-r6(16)-r4(7,3)*three-r4(7,8)-r2(4,13)*three
              rrr( 5)=-r6(17)-r4(8,3)*three
              rrr( 6)=-r6(18)-r4(9,3)*three-r4(7,8)-r2(4,13)*three
              rrr( 7)=-r6(22)-r4(11,3)*three-r4(11,8)*three-r2(2,13)*nine
              rrr( 8)=-r6(23)-r4(12,3)*three-r4(12,8)-r2(6,13)*three
              rrr( 9)=-r6(24)-r4(13,3)*three-r4(11,8)-r2(2,13)*three
              rrr(10)=-r6(25)-r4(14,3)*three-r4(12,8)*three-r2(6,13)*nine
              rxyz( 1)=-r5(7,3)-r3(2,8)*three-r3(7,16)-r1(2,16)*three
              rxyz( 2)=-r5(7,4)-r3(2,9)*three-r3(7,17)-r1(2,17)*three
              rxyz( 3)=-r4(7,9)-r2(4,14)*three
              rxyz( 4)=-r4(7,10)-r2(4,15)*three
              rxyz( 5)=-r3(7,18)-r1(2,18)*three
              rxyz( 6)=-r5(16,4)-r3(7,9)*three-r3(7,17)-r1(2,17)*three
              rxyz( 7)=-r5(18,3)-r3(9,8)*three-r3(7,16)-r1(2,16)*three
              rxyz( 8)=-r5(18,4)-r3(9,9)*three-r3(7,17)-r1(2,17)*three
              rxyz( 9)=-r5(12,3)-r3(5,8)*three
              rxyz(10)=-r5(12,4)-r3(5,9)*three
              rxyz(11)=-r4(12,9)-r2(6,14)*three
              rxyz(12)=-r4(12,10)-r2(6,15)*three
              rxyz(13)=-r5(11,3)-r3(4,8)*three
              rxyz(14)=-r5(11,4)-r3(4,9)*three
              rxyz(15)=-r5(17,3)-r3(8,8)*three
              rxyz(16)=-r5(17,4)-r3(8,9)*three
              rxyz(17)=-r4(11,9)-r2(2,14)*three
              rxyz(18)=-r4(11,10)-r2(2,15)*three
              rxyz(19)=-r5(16,3)-r3(7,8)*three-r3(7,16)-r1(2,16)*three
            case(9)
              rrr( 1)=-r6(9)+r5(5,1)*two-r4(2,1)-r4(2,3)-r4(9,8)*three+r3(5,10)*six &
&                     -r2(4,7)*three-r2(4,13)*three
              rrr( 2)=-r6(13)+r5(8,1)*two-r4(4,1)-r4(4,3)-r4(13,8)+r3(8,10)*two-r2(2,7)-r2(2,13)
              rrr( 3)=-r6(14)+r5(9,1)*two-r4(5,1)-r4(5,3)-r4(14,8)+r3(9,10)*two-r2(6,7)-r2(6,13)
              rrr( 4)=-r6(18)+r5(12,1)*two-r4(7,1)-r4(7,3)-r4(9,8)+r3(5,10)*two-r2(4,7)-r2(4,13)
              rrr( 5)=-r6(19)+r5(13,1)*two-r4(8,1)-r4(8,3)
              rrr( 6)=-r6(20)+r5(14,1)*two-r4(9,1)-r4(9,3)-r4(9,8)+r3(5,10)*two-r2(4,7)-r2(4,13)
              rrr( 7)=-r6(24)+r5(17,1)*two-r4(11,1)-r4(11,3)-r4(13,8)*three+r3(8,10)*six &
&                     -r2(2,7)*three-r2(2,13)*three
              rrr( 8)=-r6(25)+r5(18,1)*two-r4(12,1)-r4(12,3)-r4(14,8)+r3(9,10)*two-r2(6,7)-r2(6,13)
              rrr( 9)=-r6(26)+r5(19,1)*two-r4(13,1)-r4(13,3)-r4(13,8)+r3(8,10)*two-r2(2,7)-r2(2,13)
              rrr(10)=-r6(27)+r5(20,1)*two-r4(14,1)-r4(14,3)-r4(14,8)*three+r3(9,10)*six &
&                     -r2(6,7)*three-r2(6,13)*three
              rxyz( 1)=-r5(9,3)+r4(5,4)*two-r3(2,4)-r3(2,8)-r3(9,16)+r2(6,16)*two-r1(2,10)-r1(2,16)
              rxyz( 2)=-r5(9,4)+r4(5,5)*two-r3(2,5)-r3(2,9)-r3(9,17)+r2(6,17)*two-r1(2,11)-r1(2,17)
              rxyz( 3)=-r4(9,9)+r3(5,11)*two-r2(4,8)-r2(4,14)
              rxyz( 4)=-r4(9,10)+r3(5,12)*two-r2(4,9)-r2(4,15)
              rxyz( 5)=-r3(9,18)+r2(6,18)*two-r1(2,12)-r1(2,18)
              rxyz( 6)=-r5(18,4)+r4(12,5)*two-r3(7,5)-r3(7,9)-r3(9,17)+r2(6,17)*two-r1(2,11) &
&                      -r1(2,17)
              rxyz( 7)=-r5(20,3)+r4(14,4)*two-r3(9,4)-r3(9,8)-r3(9,16)+r2(6,16)*two-r1(2,10) &
&                      -r1(2,16)
              rxyz( 8)=-r5(20,4)+r4(14,5)*two-r3(9,5)-r3(9,9)-r3(9,17)+r2(6,17)*two-r1(2,11) &
&                      -r1(2,17)
              rxyz( 9)=-r5(14,3)+r4(9,4)*two-r3(5,4)-r3(5,8)
              rxyz(10)=-r5(14,4)+r4(9,5)*two-r3(5,5)-r3(5,9)
              rxyz(11)=-r4(14,9)+r3(9,11)*two-r2(6,8)-r2(6,14)
              rxyz(12)=-r4(14,10)+r3(9,12)*two-r2(6,9)-r2(6,15)
              rxyz(13)=-r5(13,3)+r4(8,4)*two-r3(4,4)-r3(4,8)
              rxyz(14)=-r5(13,4)+r4(8,5)*two-r3(4,5)-r3(4,9)
              rxyz(15)=-r5(19,3)+r4(13,4)*two-r3(8,4)-r3(8,8)
              rxyz(16)=-r5(19,4)+r4(13,5)*two-r3(8,5)-r3(8,9)
              rxyz(17)=-r4(13,9)+r3(8,11)*two-r2(2,8)-r2(2,14)
              rxyz(18)=-r4(13,10)+r3(8,12)*two-r2(2,9)-r2(2,15)
              rxyz(19)=-r5(18,3)+r4(12,4)*two-r3(7,4)-r3(7,8)-r3(9,16)+r2(6,16)*two-r1(2,10) &
&                      -r1(2,16)
            case(10)
              do k= 1,3
                do l= 1,6
                  eri(l,k,4,2)= eri(l,k,2,1)
                enddo
              enddo
              cycle
            case(11)
              do k= 1,3
                do l= 1,6
                  eri(l,k,5,2)= eri(l,k,6,1)
                enddo
              enddo
              cycle
            case(12)
              rrr( 1)=-r6(8)+r5(4,1)-r4(3,3)-r4(8,8)*three+r3(1,2)+r3(4,10)*three &
&                     -r2(5,13)*three+r1(1,4)*three
              rrr( 2)=-r6(12)+r5(7,1)-r4(5,3)-r4(12,8)+r3(2,2)+r3(7,10)-r2(6,13)+r1(2,4)
              rrr( 3)=-r6(13)+r5(8,1)-r4(6,3)-r4(13,8)+r3(3,2)+r3(8,10)-r2(3,13)+r1(3,4)
              rrr( 4)=-r6(17)+r5(11,1)-r4(8,3)-r4(8,8)+r3(4,2)+r3(4,10)-r2(5,13)+r1(1,4)
              rrr( 5)=-r6(18)+r5(12,1)-r4(9,3)+r3(5,2)
              rrr( 6)=-r6(19)+r5(13,1)-r4(10,3)-r4(8,8)+r3(6,2)+r3(4,10)-r2(5,13)+r1(1,4)
              rrr( 7)=-r6(23)+r5(16,1)-r4(12,3)-r4(12,8)*three+r3(7,2)+r3(7,10)*three &
&                     -r2(6,13)*three+r1(2,4)*three
              rrr( 8)=-r6(24)+r5(17,1)-r4(13,3)-r4(13,8)+r3(8,2)+r3(8,10)-r2(3,13)+r1(3,4)
              rrr( 9)=-r6(25)+r5(18,1)-r4(14,3)-r4(12,8)+r3(9,2)+r3(7,10)-r2(6,13)+r1(2,4)
              rrr(10)=-r6(26)+r5(19,1)-r4(15,3)-r4(13,8)*three+r3(10,2)+r3(8,10)*three &
&                     -r2(3,13)*three+r1(3,4)*three
              rxyz( 1)=-r5(8,3)+r4(4,4)-r3(3,8)-r3(8,16)+r2(1,3)+r2(2,16)-r1(3,16)+r0(4)
              rxyz( 2)=-r5(8,4)+r4(4,5)-r3(3,9)-r3(8,17)+r2(1,4)+r2(2,17)-r1(3,17)+r0(5)
              rxyz( 3)=-r4(8,9)+r3(4,11)-r2(5,14)+r1(1,5)
              rxyz( 4)=-r4(8,10)+r3(4,12)-r2(5,15)+r1(1,6)
              rxyz( 5)=-r3(8,18)+r2(2,18)-r1(3,18)+r0(6)
              rxyz( 6)=-r5(17,4)+r4(11,5)-r3(8,9)-r3(8,17)+r2(2,4)+r2(2,17)-r1(3,17)+r0(5)
              rxyz( 7)=-r5(19,3)+r4(13,4)-r3(10,8)-r3(8,16)+r2(3,3)+r2(2,16)-r1(3,16)+r0(4)
              rxyz( 8)=-r5(19,4)+r4(13,5)-r3(10,9)-r3(8,17)+r2(3,4)+r2(2,17)-r1(3,17)+r0(5)
              rxyz( 9)=-r5(13,3)+r4(8,4)-r3(6,8)+r2(5,3)
              rxyz(10)=-r5(13,4)+r4(8,5)-r3(6,9)+r2(5,4)
              rxyz(11)=-r4(13,9)+r3(8,11)-r2(3,14)+r1(3,5)
              rxyz(12)=-r4(13,10)+r3(8,12)-r2(3,15)+r1(3,6)
              rxyz(13)=-r5(12,3)+r4(7,4)-r3(5,8)+r2(4,3)
              rxyz(14)=-r5(12,4)+r4(7,5)-r3(5,9)+r2(4,4)
              rxyz(15)=-r5(18,3)+r4(12,4)-r3(9,8)+r2(6,3)
              rxyz(16)=-r5(18,4)+r4(12,5)-r3(9,9)+r2(6,4)
              rxyz(17)=-r4(12,9)+r3(7,11)-r2(6,14)+r1(2,5)
              rxyz(18)=-r4(12,10)+r3(7,12)-r2(6,15)+r1(2,6)
              rxyz(19)=-r5(17,3)+r4(11,4)-r3(8,8)-r3(8,16)+r2(2,3)+r2(2,16)-r1(3,16)+r0(4)
            case(13)
              rrr( 1)=-r6(3)+r5(1,2)-r4(3,3)-r4(3,8)*three+r3(1,3)+r3(1,13)*three &
&                     -r2(5,13)*three+r1(1,7)*three
              rrr( 2)=-r6(5)+r5(2,2)-r4(5,3)-r4(5,8)+r3(2,3)+r3(2,13)-r2(6,13)+r1(2,7)
              rrr( 3)=-r6(6)+r5(3,2)-r4(6,3)-r4(6,8)+r3(3,3)+r3(3,13)-r2(3,13)+r1(3,7)
              rrr( 4)=-r6(8)+r5(4,2)-r4(8,3)-r4(3,8)+r3(4,3)+r3(1,13)-r2(5,13)+r1(1,7)
              rrr( 5)=-r6(9)+r5(5,2)-r4(9,3)+r3(5,3)
              rrr( 6)=-r6(10)+r5(6,2)-r4(10,3)-r4(3,8)+r3(6,3)+r3(1,13)-r2(5,13)+r1(1,7)
              rrr( 7)=-r6(12)+r5(7,2)-r4(12,3)-r4(5,8)*three+r3(7,3)+r3(2,13)*three &
&                     -r2(6,13)*three+r1(2,7)*three
              rrr( 8)=-r6(13)+r5(8,2)-r4(13,3)-r4(6,8)+r3(8,3)+r3(3,13)-r2(3,13)+r1(3,7)
              rrr( 9)=-r6(14)+r5(9,2)-r4(14,3)-r4(5,8)+r3(9,3)+r3(2,13)-r2(6,13)+r1(2,7)
              rrr(10)=-r6(15)+r5(10,2)-r4(15,3)-r4(6,8)*three+r3(10,3)+r3(3,13)*three &
&                     -r2(3,13)*three+r1(3,7)*three
              rxyz( 1)=-r5(3,3)+r4(1,6)-r3(3,8)-r3(3,16)+r2(1,5)+r2(1,19)-r1(3,16)+r0(7)
              rxyz( 2)=-r5(3,4)+r4(1,7)-r3(3,9)-r3(3,17)+r2(1,6)+r2(1,20)-r1(3,17)+r0(8)
              rxyz( 3)=-r4(3,9)+r3(1,14)-r2(5,14)+r1(1,8)
              rxyz( 4)=-r4(3,10)+r3(1,15)-r2(5,15)+r1(1,9)
              rxyz( 5)=-r3(3,18)+r2(1,21)-r1(3,18)+r0(9)
              rxyz( 6)=-r5(8,4)+r4(4,7)-r3(8,9)-r3(3,17)+r2(2,6)+r2(1,20)-r1(3,17)+r0(8)
              rxyz( 7)=-r5(10,3)+r4(6,6)-r3(10,8)-r3(3,16)+r2(3,5)+r2(1,19)-r1(3,16)+r0(7)
              rxyz( 8)=-r5(10,4)+r4(6,7)-r3(10,9)-r3(3,17)+r2(3,6)+r2(1,20)-r1(3,17)+r0(8)
              rxyz( 9)=-r5(6,3)+r4(3,6)-r3(6,8)+r2(5,5)
              rxyz(10)=-r5(6,4)+r4(3,7)-r3(6,9)+r2(5,6)
              rxyz(11)=-r4(6,9)+r3(3,14)-r2(3,14)+r1(3,8)
              rxyz(12)=-r4(6,10)+r3(3,15)-r2(3,15)+r1(3,9)
              rxyz(13)=-r5(5,3)+r4(2,6)-r3(5,8)+r2(4,5)
              rxyz(14)=-r5(5,4)+r4(2,7)-r3(5,9)+r2(4,6)
              rxyz(15)=-r5(9,3)+r4(5,6)-r3(9,8)+r2(6,5)
              rxyz(16)=-r5(9,4)+r4(5,7)-r3(9,9)+r2(6,6)
              rxyz(17)=-r4(5,9)+r3(2,14)-r2(6,14)+r1(2,8)
              rxyz(18)=-r4(5,10)+r3(2,15)-r2(6,15)+r1(2,9)
              rxyz(19)=-r5(8,3)+r4(4,6)-r3(8,8)-r3(3,16)+r2(2,5)+r2(1,19)-r1(3,16)+r0(7)
            case(14)
              rrr( 1)=-r6(8)+r5(4,2)-r4(3,3)-r4(8,8)*three+r3(1,3)+r3(4,13)*three &
&                     -r2(5,13)*three+r1(1,7)*three
              rrr( 2)=-r6(12)+r5(7,2)-r4(5,3)-r4(12,8)+r3(2,3)+r3(7,13)-r2(6,13)+r1(2,7)
              rrr( 3)=-r6(13)+r5(8,2)-r4(6,3)-r4(13,8)+r3(3,3)+r3(8,13)-r2(3,13)+r1(3,7)
              rrr( 4)=-r6(17)+r5(11,2)-r4(8,3)-r4(8,8)+r3(4,3)+r3(4,13)-r2(5,13)+r1(1,7)
              rrr( 5)=-r6(18)+r5(12,2)-r4(9,3)+r3(5,3)
              rrr( 6)=-r6(19)+r5(13,2)-r4(10,3)-r4(8,8)+r3(6,3)+r3(4,13)-r2(5,13)+r1(1,7)
              rrr( 7)=-r6(23)+r5(16,2)-r4(12,3)-r4(12,8)*three+r3(7,3)+r3(7,13)*three &
&                     -r2(6,13)*three+r1(2,7)*three
              rrr( 8)=-r6(24)+r5(17,2)-r4(13,3)-r4(13,8)+r3(8,3)+r3(8,13)-r2(3,13)+r1(3,7)
              rrr( 9)=-r6(25)+r5(18,2)-r4(14,3)-r4(12,8)+r3(9,3)+r3(7,13)-r2(6,13)+r1(2,7)
              rrr(10)=-r6(26)+r5(19,2)-r4(15,3)-r4(13,8)*three+r3(10,3)+r3(8,13)*three &
&                     -r2(3,13)*three+r1(3,7)*three
              rxyz( 1)=-r5(8,3)+r4(4,6)-r3(3,8)-r3(8,16)+r2(1,5)+r2(2,19)-r1(3,16)+r0(7)
              rxyz( 2)=-r5(8,4)+r4(4,7)-r3(3,9)-r3(8,17)+r2(1,6)+r2(2,20)-r1(3,17)+r0(8)
              rxyz( 3)=-r4(8,9)+r3(4,14)-r2(5,14)+r1(1,8)
              rxyz( 4)=-r4(8,10)+r3(4,15)-r2(5,15)+r1(1,9)
              rxyz( 5)=-r3(8,18)+r2(2,21)-r1(3,18)+r0(9)
              rxyz( 6)=-r5(17,4)+r4(11,7)-r3(8,9)-r3(8,17)+r2(2,6)+r2(2,20)-r1(3,17)+r0(8)
              rxyz( 7)=-r5(19,3)+r4(13,6)-r3(10,8)-r3(8,16)+r2(3,5)+r2(2,19)-r1(3,16)+r0(7)
              rxyz( 8)=-r5(19,4)+r4(13,7)-r3(10,9)-r3(8,17)+r2(3,6)+r2(2,20)-r1(3,17)+r0(8)
              rxyz( 9)=-r5(13,3)+r4(8,6)-r3(6,8)+r2(5,5)
              rxyz(10)=-r5(13,4)+r4(8,7)-r3(6,9)+r2(5,6)
              rxyz(11)=-r4(13,9)+r3(8,14)-r2(3,14)+r1(3,8)
              rxyz(12)=-r4(13,10)+r3(8,15)-r2(3,15)+r1(3,9)
              rxyz(13)=-r5(12,3)+r4(7,6)-r3(5,8)+r2(4,5)
              rxyz(14)=-r5(12,4)+r4(7,7)-r3(5,9)+r2(4,6)
              rxyz(15)=-r5(18,3)+r4(12,6)-r3(9,8)+r2(6,5)
              rxyz(16)=-r5(18,4)+r4(12,7)-r3(9,9)+r2(6,6)
              rxyz(17)=-r4(12,9)+r3(7,14)-r2(6,14)+r1(2,8)
              rxyz(18)=-r4(12,10)+r3(7,15)-r2(6,15)+r1(2,9)
              rxyz(19)=-r5(17,3)+r4(11,6)-r3(8,8)-r3(8,16)+r2(2,5)+r2(2,19)-r1(3,16)+r0(7)
            case(15)
              rrr( 1)=-r6(10)+r5(6,1)*two+r5(6,2)-r4(3,1)-r4(3,2)*two-r4(3,3)*three &
&                     -r4(10,8)*three+r3(1,1)+r3(1,2)*two+r3(1,3)+r3(6,10)*six+r3(6,13)*three &
&                     -r2(5,7)*three-r2(5,10)*six-r2(5,13)*nine+r1(1,1)*three+r1(1,4)*six &
&                     +r1(1,7)*three
              rrr( 2)=-r6(14)+r5(9,1)*two+r5(9,2)-r4(5,1)-r4(5,2)*two-r4(5,3)*three-r4(14,8) &
&                     +r3(2,1)+r3(2,2)*two+r3(2,3)+r3(9,10)*two+r3(9,13)-r2(6,7)-r2(6,10)*two &
&                     -r2(6,13)*three+r1(2,1)+r1(2,4)*two+r1(2,7)
              rrr( 3)=-r6(15)+r5(10,1)*two+r5(10,2)-r4(6,1)-r4(6,2)*two-r4(6,3)*three &
&                     -r4(15,8)+r3(3,1)+r3(3,2)*two+r3(3,3)+r3(10,10)*two+r3(10,13)-r2(3,7) &
&                     -r2(3,10)*two-r2(3,13)*three+r1(3,1)+r1(3,4)*two+r1(3,7)
              rrr( 4)=-r6(19)+r5(13,1)*two+r5(13,2)-r4(8,1)-r4(8,2)*two-r4(8,3)*three &
&                     -r4(10,8)+r3(4,1)+r3(4,2)*two+r3(4,3)+r3(6,10)*two+r3(6,13)-r2(5,7) &
&                     -r2(5,10)*two-r2(5,13)*three+r1(1,1)+r1(1,4)*two+r1(1,7)
              rrr( 5)=-r6(20)+r5(14,1)*two+r5(14,2)-r4(9,1)-r4(9,2)*two-r4(9,3)*three &
&                     +r3(5,1)+r3(5,2)*two+r3(5,3)
              rrr( 6)=-r6(21)+r5(15,1)*two+r5(15,2)-r4(10,1)-r4(10,2)*two-r4(10,3)*three &
&                     -r4(10,8)+r3(6,1)+r3(6,2)*two+r3(6,3)+r3(6,10)*two+r3(6,13)-r2(5,7) &
&                     -r2(5,10)*two-r2(5,13)*three+r1(1,1)+r1(1,4)*two+r1(1,7)
              rrr( 7)=-r6(25)+r5(18,1)*two+r5(18,2)-r4(12,1)-r4(12,2)*two-r4(12,3)*three &
&                     -r4(14,8)*three+r3(7,1)+r3(7,2)*two+r3(7,3)+r3(9,10)*six+r3(9,13)*three &
&                     -r2(6,7)*three-r2(6,10)*six-r2(6,13)*nine+r1(2,1)*three+r1(2,4)*six &
&                     +r1(2,7)*three
              rrr( 8)=-r6(26)+r5(19,1)*two+r5(19,2)-r4(13,1)-r4(13,2)*two-r4(13,3)*three &
&                     -r4(15,8)+r3(8,1)+r3(8,2)*two+r3(8,3)+r3(10,10)*two+r3(10,13)-r2(3,7) &
&                     -r2(3,10)*two-r2(3,13)*three+r1(3,1)+r1(3,4)*two+r1(3,7)
              rrr( 9)=-r6(27)+r5(20,1)*two+r5(20,2)-r4(14,1)-r4(14,2)*two-r4(14,3)*three &
&                     -r4(14,8)+r3(9,1)+r3(9,2)*two+r3(9,3)+r3(9,10)*two+r3(9,13)-r2(6,7) &
&                     -r2(6,10)*two-r2(6,13)*three+r1(2,1)+r1(2,4)*two+r1(2,7)
              rrr(10)=-r6(28)+r5(21,1)*two+r5(21,2)-r4(15,1)-r4(15,2)*two-r4(15,3)*three &
&                     -r4(15,8)*three+r3(10,1)+r3(10,2)*two+r3(10,3)+r3(10,10)*six &
&                     +r3(10,13)*three-r2(3,7)*three-r2(3,10)*six-r2(3,13)*nine+r1(3,1)*three &
&                     +r1(3,4)*six+r1(3,7)*three
              rxyz( 1)=-r5(10,3)+r4(6,4)*two+r4(6,6)-r3(3,4)-r3(3,6)*two-r3(3,8)*three-r3(10,16) &
&                      +r2(1,1)+r2(1,3)*two+r2(1,5)+r2(3,16)*two+r2(3,19)-r1(3,10)-r1(3,13)*two &
&                      -r1(3,16)*three+r0(1)+r0(4)*two+r0(7)
              rxyz( 2)=-r5(10,4)+r4(6,5)*two+r4(6,7)-r3(3,5)-r3(3,7)*two-r3(3,9)*three-r3(10,17) &
&                      +r2(1,2)+r2(1,4)*two+r2(1,6)+r2(3,17)*two+r2(3,20)-r1(3,11)-r1(3,14)*two &
&                      -r1(3,17)*three+r0(2)+r0(5)*two+r0(8)
              rxyz( 3)=-r4(10,9)+r3(6,11)*two+r3(6,14)-r2(5,8)-r2(5,11)*two-r2(5,14)*three &
&                      +r1(1,2)+r1(1,5)*two+r1(1,8)
              rxyz( 4)=-r4(10,10)+r3(6,12)*two+r3(6,15)-r2(5,9)-r2(5,12)*two-r2(5,15)*three &
&                      +r1(1,3)+r1(1,6)*two+r1(1,9)
              rxyz( 5)=-r3(10,18)+r2(3,18)*two+r2(3,21)-r1(3,12)-r1(3,15)*two-r1(3,18)*three &
&                      +r0(3)+r0(6)*two+r0(9)
              rxyz( 6)=-r5(19,4)+r4(13,5)*two+r4(13,7)-r3(8,5)-r3(8,7)*two-r3(8,9)*three &
&                      -r3(10,17)+r2(2,2)+r2(2,4)*two+r2(2,6)+r2(3,17)*two+r2(3,20)-r1(3,11) &
&                      -r1(3,14)*two-r1(3,17)*three+r0(2)+r0(5)*two+r0(8)
              rxyz( 7)=-r5(21,3)+r4(15,4)*two+r4(15,6)-r3(10,4)-r3(10,6)*two-r3(10,8)*three &
&                      -r3(10,16)+r2(3,1)+r2(3,3)*two+r2(3,5)+r2(3,16)*two+r2(3,19)-r1(3,10) &
&                      -r1(3,13)*two-r1(3,16)*three+r0(1)+r0(4)*two+r0(7)
              rxyz( 8)=-r5(21,4)+r4(15,5)*two+r4(15,7)-r3(10,5)-r3(10,7)*two-r3(10,9)*three &
&                      -r3(10,17)+r2(3,2)+r2(3,4)*two+r2(3,6)+r2(3,17)*two+r2(3,20)-r1(3,11) &
&                      -r1(3,14)*two-r1(3,17)*three+r0(2)+r0(5)*two+r0(8)
              rxyz( 9)=-r5(15,3)+r4(10,4)*two+r4(10,6)-r3(6,4)-r3(6,6)*two-r3(6,8)*three+r2(5,1) &
&                      +r2(5,3)*two+r2(5,5)
              rxyz(10)=-r5(15,4)+r4(10,5)*two+r4(10,7)-r3(6,5)-r3(6,7)*two-r3(6,9)*three+r2(5,2) &
&                      +r2(5,4)*two+r2(5,6)
              rxyz(11)=-r4(15,9)+r3(10,11)*two+r3(10,14)-r2(3,8)-r2(3,11)*two-r2(3,14)*three &
&                      +r1(3,2)+r1(3,5)*two+r1(3,8)
              rxyz(12)=-r4(15,10)+r3(10,12)*two+r3(10,15)-r2(3,9)-r2(3,12)*two-r2(3,15)*three &
&                      +r1(3,3)+r1(3,6)*two+r1(3,9)
              rxyz(13)=-r5(14,3)+r4(9,4)*two+r4(9,6)-r3(5,4)-r3(5,6)*two-r3(5,8)*three+r2(4,1) &
&                      +r2(4,3)*two+r2(4,5)
              rxyz(14)=-r5(14,4)+r4(9,5)*two+r4(9,7)-r3(5,5)-r3(5,7)*two-r3(5,9)*three+r2(4,2) &
&                      +r2(4,4)*two +r2(4,6)
              rxyz(15)=-r5(20,3)+r4(14,4)*two+r4(14,6)-r3(9,4)-r3(9,6)*two-r3(9,8)*three+r2(6,1) &
&                      +r2(6,3)*two+r2(6,5)
              rxyz(16)=-r5(20,4)+r4(14,5)*two+r4(14,7)-r3(9,5)-r3(9,7)*two-r3(9,9)*three+r2(6,2) &
&                      +r2(6,4)*two+r2(6,6)
              rxyz(17)=-r4(14,9)+r3(9,11)*two+r3(9,14)-r2(6,8)-r2(6,11)*two-r2(6,14)*three &
&                      +r1(2,2)+r1(2,5)*two+r1(2,8)
              rxyz(18)=-r4(14,10)+r3(9,12)*two+r3(9,15)-r2(6,9)-r2(6,12)*two-r2(6,15)*three &
&                      +r1(2,3)+r1(2,6)*two+r1(2,9)
              rxyz(19)=-r5(19,3)+r4(13,4)*two+r4(13,6)-r3(8,4)-r3(8,6)*two-r3(8,8)*three &
&                      -r3(10,16)+r2(2,1)+r2(2,3)*two+r2(2,5)+r2(3,16)*two+r2(3,19)-r1(3,10) &
&                      -r1(3,13)*two-r1(3,16)*three+r0(1)+r0(4)*two+r0(7)
            case(16)
              rrr( 1)=-r6(5)+r5(2,2)-r4(5,8)*three+r3(2,13)*three
              rrr( 2)=-r6(8)+r5(4,2)-r4(8,8)+r3(4,13)
              rrr( 3)=-r6(9)+r5(5,2)-r4(9,8)+r3(5,13)
              rrr( 4)=-r6(12)+r5(7,2)-r4(5,8)+r3(2,13)
              rrr( 5)=-r6(13)+r5(8,2)
              rrr( 6)=-r6(14)+r5(9,2)-r4(5,8)+r3(2,13)
              rrr( 7)=-r6(17)+r5(11,2)-r4(8,8)*three+r3(4,13)*three
              rrr( 8)=-r6(18)+r5(12,2)-r4(9,8)+r3(5,13)
              rrr( 9)=-r6(19)+r5(13,2)-r4(8,8)+r3(4,13)
              rrr(10)=-r6(20)+r5(14,2)-r4(9,8)*three+r3(5,13)*three
              rxyz( 1)=-r5(5,3)+r4(2,6)-r3(5,16)+r2(4,19)
              rxyz( 2)=-r5(5,4)+r4(2,7)-r3(5,17)+r2(4,20)
              rxyz( 3)=-r4(5,9)+r3(2,14)
              rxyz( 4)=-r4(5,10)+r3(2,15)
              rxyz( 5)=-r3(5,18)+r2(4,21)
              rxyz( 6)=-r5(12,4)+r4(7,7)-r3(5,17)+r2(4,20)
              rxyz( 7)=-r5(14,3)+r4(9,6)-r3(5,16)+r2(4,19)
              rxyz( 8)=-r5(14,4)+r4(9,7)-r3(5,17)+r2(4,20)
              rxyz( 9)=-r5(9,3)+r4(5,6)
              rxyz(10)=-r5(9,4)+r4(5,7)
              rxyz(11)=-r4(9,9)+r3(5,14)
              rxyz(12)=-r4(9,10)+r3(5,15)
              rxyz(13)=-r5(8,3)+r4(4,6)
              rxyz(14)=-r5(8,4)+r4(4,7)
              rxyz(15)=-r5(13,3)+r4(8,6)
              rxyz(16)=-r5(13,4)+r4(8,7)
              rxyz(17)=-r4(8,9)+r3(4,14)
              rxyz(18)=-r4(8,10)+r3(4,15)
              rxyz(19)=-r5(12,3)+r4(7,6)-r3(5,16)+r2(4,19)
            case(17)
              rrr( 1)=-r6(6)+r5(3,1)+r5(3,2)-r4(1,2)-r4(1,3)-r4(6,8)*three+r3(3,10)*three &
&                     +r3(3,13)*three-r2(1,10)*three-r2(1,13)*three
              rrr( 2)=-r6(9)+r5(5,1)+r5(5,2)-r4(2,2)-r4(2,3)-r4(9,8)+r3(5,10)+r3(5,13) &
&                     -r2(4,10)-r2(4,13)
              rrr( 3)=-r6(10)+r5(6,1)+r5(6,2)-r4(3,2)-r4(3,3)-r4(10,8)+r3(6,10)+r3(6,13) &
&                     -r2(5,10)-r2(5,13)
              rrr( 4)=-r6(13)+r5(8,1)+r5(8,2)-r4(4,2)-r4(4,3)-r4(6,8)+r3(3,10)+r3(3,13) &
&                     -r2(1,10)-r2(1,13)
              rrr( 5)=-r6(14)+r5(9,1)+r5(9,2)-r4(5,2)-r4(5,3)
              rrr( 6)=-r6(15)+r5(10,1)+r5(10,2)-r4(6,2)-r4(6,3)-r4(6,8)+r3(3,10)+r3(3,13) &
&                     -r2(1,10)-r2(1,13)
              rrr( 7)=-r6(18)+r5(12,1)+r5(12,2)-r4(7,2)-r4(7,3)-r4(9,8)*three+r3(5,10)*three &
&                     +r3(5,13)*three-r2(4,10)*three-r2(4,13)*three
              rrr( 8)=-r6(19)+r5(13,1)+r5(13,2)-r4(8,2)-r4(8,3)-r4(10,8)+r3(6,10)+r3(6,13) &
&                     -r2(5,10)-r2(5,13)
              rrr( 9)=-r6(20)+r5(14,1)+r5(14,2)-r4(9,2)-r4(9,3)-r4(9,8)+r3(5,10)+r3(5,13) &
&                     -r2(4,10)-r2(4,13)
              rrr(10)=-r6(21)+r5(15,1)+r5(15,2)-r4(10,2)-r4(10,3)-r4(10,8)*three &
&                     +r3(6,10)*three+r3(6,13)*three-r2(5,10)*three-r2(5,13)*three
              rxyz( 1)=-r5(6,3)+r4(3,4)+r4(3,6)-r3(1,6)-r3(1,8)-r3(6,16)+r2(5,16)+r2(5,19) &
&                      -r1(1,13)-r1(1,16)
              rxyz( 2)=-r5(6,4)+r4(3,5)+r4(3,7)-r3(1,7)-r3(1,9)-r3(6,17)+r2(5,17)+r2(5,20) &
&                      -r1(1,14)-r1(1,17)
              rxyz( 3)=-r4(6,9)+r3(3,11)+r3(3,14)-r2(1,11)-r2(1,14)
              rxyz( 4)=-r4(6,10)+r3(3,12)+r3(3,15)-r2(1,12)-r2(1,15)
              rxyz( 5)=-r3(6,18)+r2(5,18)+r2(5,21)-r1(1,15)-r1(1,18)
              rxyz( 6)=-r5(13,4)+r4(8,5)+r4(8,7)-r3(4,7)-r3(4,9)-r3(6,17)+r2(5,17)+r2(5,20) &
&                      -r1(1,14)-r1(1,17)
              rxyz( 7)=-r5(15,3)+r4(10,4)+r4(10,6)-r3(6,6)-r3(6,8)-r3(6,16)+r2(5,16)+r2(5,19) &
&                      -r1(1,13)-r1(1,16)
              rxyz( 8)=-r5(15,4)+r4(10,5)+r4(10,7)-r3(6,7)-r3(6,9)-r3(6,17)+r2(5,17)+r2(5,20) &
&                      -r1(1,14)-r1(1,17)
              rxyz( 9)=-r5(10,3)+r4(6,4)+r4(6,6)-r3(3,6)-r3(3,8)
              rxyz(10)=-r5(10,4)+r4(6,5)+r4(6,7)-r3(3,7)-r3(3,9)
              rxyz(11)=-r4(10,9)+r3(6,11)+r3(6,14)-r2(5,11)-r2(5,14)
              rxyz(12)=-r4(10,10)+r3(6,12)+r3(6,15)-r2(5,12)-r2(5,15)
              rxyz(13)=-r5(9,3)+r4(5,4)+r4(5,6)-r3(2,6)-r3(2,8)
              rxyz(14)=-r5(9,4)+r4(5,5)+r4(5,7)-r3(2,7)-r3(2,9)
              rxyz(15)=-r5(14,3)+r4(9,4)+r4(9,6)-r3(5,6)-r3(5,8)
              rxyz(16)=-r5(14,4)+r4(9,5)+r4(9,7)-r3(5,7)-r3(5,9)
              rxyz(17)=-r4(9,9)+r3(5,11)+r3(5,14)-r2(4,11)-r2(4,14)
              rxyz(18)=-r4(9,10)+r3(5,12)+r3(5,15)-r2(4,12)-r2(4,15)
              rxyz(19)=-r5(13,3)+r4(8,4)+r4(8,6)-r3(4,6)-r3(4,8)-r3(6,16)+r2(5,16)+r2(5,19) &
&                      -r1(1,13)-r1(1,16)
            case(18)
              rrr( 1)=-r6(9)+r5(5,1)+r5(5,2)-r4(2,2)-r4(2,3)-r4(9,8)*three+r3(5,10)*three &
&                     +r3(5,13)*three-r2(4,10)*three-r2(4,13)*three
              rrr( 2)=-r6(13)+r5(8,1)+r5(8,2)-r4(4,2)-r4(4,3)-r4(13,8)+r3(8,10)+r3(8,13) &
&                     -r2(2,10)-r2(2,13)
              rrr( 3)=-r6(14)+r5(9,1)+r5(9,2)-r4(5,2)-r4(5,3)-r4(14,8)+r3(9,10)+r3(9,13) &
&                     -r2(6,10)-r2(6,13)
              rrr( 4)=-r6(18)+r5(12,1)+r5(12,2)-r4(7,2)-r4(7,3)-r4(9,8)+r3(5,10)+r3(5,13) &
&                     -r2(4,10)-r2(4,13)
              rrr( 5)=-r6(19)+r5(13,1)+r5(13,2)-r4(8,2)-r4(8,3)
              rrr( 6)=-r6(20)+r5(14,1)+r5(14,2)-r4(9,2)-r4(9,3)-r4(9,8)+r3(5,10)+r3(5,13) &
&                     -r2(4,10)-r2(4,13)
              rrr( 7)=-r6(24)+r5(17,1)+r5(17,2)-r4(11,2)-r4(11,3)-r4(13,8)*three &
&                     +r3(8,10)*three+r3(8,13)*three-r2(2,10)*three-r2(2,13)*three
              rrr( 8)=-r6(25)+r5(18,1)+r5(18,2)-r4(12,2)-r4(12,3)-r4(14,8)+r3(9,10)+r3(9,13) &
&                     -r2(6,10)-r2(6,13)
              rrr( 9)=-r6(26)+r5(19,1)+r5(19,2)-r4(13,2)-r4(13,3)-r4(13,8)+r3(8,10)+r3(8,13) &
&                     -r2(2,10)-r2(2,13)
              rrr(10)=-r6(27)+r5(20,1)+r5(20,2)-r4(14,2)-r4(14,3)-r4(14,8)*three &
&                     +r3(9,10)*three+r3(9,13)*three-r2(6,10)*three-r2(6,13)*three
              rxyz( 1)=-r5(9,3)+r4(5,4)+r4(5,6)-r3(2,6)-r3(2,8)-r3(9,16)+r2(6,16)+r2(6,19) &
&                      -r1(2,13)-r1(2,16)
              rxyz( 2)=-r5(9,4)+r4(5,5)+r4(5,7)-r3(2,7)-r3(2,9)-r3(9,17)+r2(6,17)+r2(6,20) &
&                      -r1(2,14)-r1(2,17)
              rxyz( 3)=-r4(9,9)+r3(5,11)+r3(5,14)-r2(4,11)-r2(4,14)
              rxyz( 4)=-r4(9,10)+r3(5,12)+r3(5,15)-r2(4,12)-r2(4,15)
              rxyz( 5)=-r3(9,18)+r2(6,18)+r2(6,21)-r1(2,15)-r1(2,18)
              rxyz( 6)=-r5(18,4)+r4(12,5)+r4(12,7)-r3(7,7)-r3(7,9)-r3(9,17)+r2(6,17)+r2(6,20) &
&                      -r1(2,14)-r1(2,17)
              rxyz( 7)=-r5(20,3)+r4(14,4)+r4(14,6)-r3(9,6)-r3(9,8)-r3(9,16)+r2(6,16)+r2(6,19) &
&                      -r1(2,13)-r1(2,16)
              rxyz( 8)=-r5(20,4)+r4(14,5)+r4(14,7)-r3(9,7)-r3(9,9)-r3(9,17)+r2(6,17)+r2(6,20) &
&                      -r1(2,14)-r1(2,17)
              rxyz( 9)=-r5(14,3)+r4(9,4)+r4(9,6)-r3(5,6)-r3(5,8)
              rxyz(10)=-r5(14,4)+r4(9,5)+r4(9,7)-r3(5,7)-r3(5,9)
              rxyz(11)=-r4(14,9)+r3(9,11)+r3(9,14)-r2(6,11)-r2(6,14)
              rxyz(12)=-r4(14,10)+r3(9,12)+r3(9,15)-r2(6,12)-r2(6,15)
              rxyz(13)=-r5(13,3)+r4(8,4)+r4(8,6)-r3(4,6)-r3(4,8)
              rxyz(14)=-r5(13,4)+r4(8,5)+r4(8,7)-r3(4,7)-r3(4,9)
              rxyz(15)=-r5(19,3)+r4(13,4)+r4(13,6)-r3(8,6)-r3(8,8)
              rxyz(16)=-r5(19,4)+r4(13,5)+r4(13,7)-r3(8,7)-r3(8,9)
              rxyz(17)=-r4(13,9)+r3(8,11)+r3(8,14)-r2(2,11)-r2(2,14)
              rxyz(18)=-r4(13,10)+r3(8,12)+r3(8,15)-r2(2,12)-r2(2,15)
              rxyz(19)=-r5(18,3)+r4(12,4)+r4(12,6)-r3(7,6)-r3(7,8)-r3(9,16)+r2(6,16)+r2(6,19) &
&                      -r1(2,13)-r1(2,16)
          end select
          eri(1,1,j,i)=+rrr(1)+(rxyz(1)*two+rxyz(2))*qx+(rxyz(3)+rxyz(4)*two)*xx+rxyz(5)*xxx
          eri(2,1,j,i)=+rrr(4)+rxyz(6)*qx
          eri(3,1,j,i)=+rrr(6)+rxyz(8)*qx+rxyz(9)*two*qz+rxyz(12)*two*xz+rxyz(3)*zz+rxyz(5)*xzz
          eri(4,1,j,i)=+rrr(2)+(rxyz(13)+rxyz(14))*qx+rxyz(18)*xx
          eri(5,1,j,i)=+rrr(3)+(rxyz(9)+rxyz(10))*qx+rxyz(1)*qz+rxyz(12)*xx+(rxyz(3)+rxyz(4))*xz &
&                      +rxyz(5)*xxz
          eri(6,1,j,i)=+rrr(5)+rxyz(16)*qx+rxyz(13)*qz+rxyz(18)*xz
          eri(1,2,j,i)=+rrr(2)+rxyz(13)*two*qx+rxyz(17)*xx
          eri(2,2,j,i)=+rrr(7)
          eri(3,2,j,i)=+rrr(9)+rxyz(15)*two*qz+rxyz(17)*zz
          eri(4,2,j,i)=+rrr(4)+rxyz(19)*qx
          eri(5,2,j,i)=+rrr(5)+rxyz(15)*qx+rxyz(13)*qz+rxyz(17)*xz
          eri(6,2,j,i)=+rrr(8)+rxyz(19)*qz
          eri(1,3,j,i)=+rrr(3)+rxyz(9)*two*qx+rxyz(2)*qz+rxyz(11)*xx+rxyz(4)*two*xz+rxyz(5)*xxz
          eri(2,3,j,i)=+rrr(8)+rxyz(6)*qz
          eri(3,3,j,i)=+rrr(10)+(rxyz(7)*two+rxyz(8))*qz+(rxyz(11)+rxyz(12)*two)*zz+rxyz(5)*zzz
          eri(4,3,j,i)=+rrr(5)+rxyz(15)*qx+rxyz(14)*qz+rxyz(18)*xz
          eri(5,3,j,i)=+rrr(6)+rxyz(7)*qx+(rxyz(9)+rxyz(10))*qz+(rxyz(11)+rxyz(12))*xz+rxyz(4)*zz &
&                      +rxyz(5)*xzz
          eri(6,3,j,i)=+rrr(9)+(rxyz(15)+rxyz(16))*qz+rxyz(18)*zz
        end do
      end do
!
      return
end


